"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/csp/route";
exports.ids = ["app/api/csp/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "playwright":
/*!*****************************!*\
  !*** external "playwright" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("playwright");;

/***/ }),

/***/ "node:crypto":
/*!******************************!*\
  !*** external "node:crypto" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:crypto");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcsp%2Froute&page=%2Fapi%2Fcsp%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcsp%2Froute.ts&appDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcsp%2Froute&page=%2Fapi%2Fcsp%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcsp%2Froute.ts&appDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_javie_Desktop_Game_Online_Html_autocsp_app_api_csp_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/csp/route.ts */ \"(rsc)/./app/api/csp/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/csp/route\",\n        pathname: \"/api/csp\",\n        filename: \"route\",\n        bundlePath: \"app/api/csp/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\javie\\\\Desktop\\\\Game Online Html\\\\autocsp\\\\app\\\\api\\\\csp\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_javie_Desktop_Game_Online_Html_autocsp_app_api_csp_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/csp/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjc3AlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmNzcCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmNzcCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNqYXZpZSU1Q0Rlc2t0b3AlNUNHYW1lJTIwT25saW5lJTIwSHRtbCU1Q2F1dG9jc3AlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q2phdmllJTVDRGVza3RvcCU1Q0dhbWUlMjBPbmxpbmUlMjBIdG1sJTVDYXV0b2NzcCZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDNkI7QUFDMUc7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hdXRvY3NwLz9kYjNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXGphdmllXFxcXERlc2t0b3BcXFxcR2FtZSBPbmxpbmUgSHRtbFxcXFxhdXRvY3NwXFxcXGFwcFxcXFxhcGlcXFxcY3NwXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jc3Avcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jc3BcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NzcC9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXGphdmllXFxcXERlc2t0b3BcXFxcR2FtZSBPbmxpbmUgSHRtbFxcXFxhdXRvY3NwXFxcXGFwcFxcXFxhcGlcXFxcY3NwXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jc3Avcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcsp%2Froute&page=%2Fapi%2Fcsp%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcsp%2Froute.ts&appDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/csp/route.ts":
/*!******************************!*\
  !*** ./app/api/csp/route.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   revalidate: () => (/* binding */ revalidate)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _src_fetch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../src/fetch */ \"(rsc)/./src/fetch.ts\");\n/* harmony import */ var _src_collect__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../src/collect */ \"(rsc)/./src/collect.ts\");\n/* harmony import */ var _src_builder__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../src/builder */ \"(rsc)/./src/builder.ts\");\n/* harmony import */ var _src_crawl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../src/crawl */ \"(rsc)/./src/crawl.ts\");\n/* harmony import */ var _src_risk__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../src/risk */ \"(rsc)/./src/risk.ts\");\n\n\n\n\n\n\nconst revalidate = 0;\nasync function GET(req) {\n    const url = req.nextUrl.searchParams.get(\"url\");\n    if (!url) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Missing url param\"\n        }, {\n            status: 400\n        });\n    }\n    const strictQuery = req.nextUrl.searchParams.get(\"strict\") === \"true\";\n    const runtime = req.nextUrl.searchParams.get(\"runtime\") === \"true\";\n    const depthParam = req.nextUrl.searchParams.get(\"depth\");\n    const depth = depthParam ? Math.min(3, Math.max(0, parseInt(depthParam, 10) || 0)) : 0; // cap depth to 3\n    try {\n        const page = await (0,_src_fetch__WEBPACK_IMPORTED_MODULE_1__.fetchPage)(url);\n        let resources = (0,_src_collect__WEBPACK_IMPORTED_MODULE_2__.collectResources)(page.html, page.finalUrl);\n        let runtimeStatus = \"disabled\";\n        if (runtime) {\n            try {\n                const mod = await __webpack_require__.e(/*! import() */ \"_rsc_src_runtime_ts\").then(__webpack_require__.bind(__webpack_require__, /*! ../../../src/runtime */ \"(rsc)/./src/runtime.ts\"));\n                resources = await mod.collectRuntimeResources(page.finalUrl, {\n                    waitUntil: \"networkidle\"\n                });\n                runtimeStatus = \"ok\";\n            } catch (e) {\n                // playwright not available or runtime failure; continue with static resources\n                runtimeStatus = \"unavailable\";\n            }\n        }\n        let crawledPages = [\n            page.finalUrl\n        ];\n        if (depth > 0) {\n            try {\n                const crawlRes = await (0,_src_crawl__WEBPACK_IMPORTED_MODULE_4__.crawl)(page.finalUrl, {\n                    depth,\n                    sameOriginOnly: true\n                });\n                crawledPages = crawlRes.pages;\n                // merge crawl resources\n                const merged = crawlRes.resources;\n                resources.inlineScripts.push(...merged.inlineScripts);\n                resources.inlineStyles.push(...merged.inlineStyles);\n                merged.externalScriptOrigins.forEach((o)=>resources.externalScriptOrigins.add(o));\n                merged.externalStyleOrigins.forEach((o)=>resources.externalStyleOrigins.add(o));\n                merged.imageOrigins.forEach((o)=>resources.imageOrigins.add(o));\n                merged.fontOrigins.forEach((o)=>resources.fontOrigins.add(o));\n                merged.connectOrigins.forEach((o)=>resources.connectOrigins.add(o));\n            } catch  {}\n        }\n        // Build baseline (non-strict) and strict side-by-side\n        const baseline = (0,_src_builder__WEBPACK_IMPORTED_MODULE_3__.buildCSP)(resources, {\n            strict: false,\n            existing: page.csp\n        });\n        const strict = (0,_src_builder__WEBPACK_IMPORTED_MODULE_3__.buildCSP)(resources, {\n            strict: true,\n            existing: page.csp\n        });\n        const active = strictQuery ? strict : baseline;\n        const diffModes = diffBetweenPolicies(baseline.policy, strict.policy);\n        const summaryBaseline = summarizeDirectives(baseline.directives);\n        const summaryStrict = summarizeDirectives(strict.directives);\n        const headers = recommendedHeaders();\n        const riskActive = stringifyRisk((0,_src_risk__WEBPACK_IMPORTED_MODULE_5__.assessPolicy)(active.policy));\n        const riskBaseline = stringifyRisk((0,_src_risk__WEBPACK_IMPORTED_MODULE_5__.assessPolicy)(baseline.policy));\n        const riskStrict = stringifyRisk((0,_src_risk__WEBPACK_IMPORTED_MODULE_5__.assessPolicy)(strict.policy));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            input: url,\n            finalUrl: page.finalUrl,\n            status: page.status,\n            existing: page.csp,\n            baseline: {\n                policy: baseline.policy,\n                notes: baseline.notes,\n                diffExisting: baseline.diff\n            },\n            strict: {\n                policy: strict.policy,\n                notes: strict.notes,\n                diffExisting: strict.diff\n            },\n            activeMode: strictQuery ? \"strict\" : \"baseline\",\n            runtime: runtime ? true : false,\n            runtimeStatus,\n            crawl: {\n                depth,\n                pages: crawledPages,\n                count: crawledPages.length\n            },\n            diffModes,\n            headers,\n            policy: active.policy,\n            notes: active.notes,\n            risk: {\n                active: riskActive,\n                baseline: riskBaseline,\n                strict: riskStrict\n            },\n            summaries: {\n                baseline: summaryBaseline,\n                strict: summaryStrict\n            }\n        }, {\n            headers: {\n                \"Cache-Control\": \"public, max-age=0, s-maxage=300\"\n            }\n        });\n    } catch (e) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: e.message || \"Failed\"\n        }, {\n            status: 500\n        });\n    }\n}\nfunction diffBetweenPolicies(a, b) {\n    if (a === b) return {\n        added: [],\n        removed: []\n    };\n    const setA = new Set(a.split(/;\\s*/));\n    const setB = new Set(b.split(/;\\s*/));\n    const added = [];\n    const removed = [];\n    for (const d of setB)if (!setA.has(d)) added.push(d);\n    for (const d of setA)if (!setB.has(d)) removed.push(d);\n    return {\n        added,\n        removed\n    };\n}\nfunction recommendedHeaders() {\n    return {\n        \"Referrer-Policy\": \"strict-origin-when-cross-origin\",\n        \"Permissions-Policy\": [\n            \"accelerometer=()\",\n            \"ambient-light-sensor=()\",\n            \"autoplay=(self)\",\n            \"battery=()\",\n            \"camera=()\",\n            \"display-capture=()\",\n            \"encrypted-media=()\",\n            \"fullscreen=(self)\",\n            \"geolocation=()\",\n            \"gyroscope=()\",\n            \"magnetometer=()\",\n            \"microphone=()\",\n            \"midi=()\",\n            \"payment=()\",\n            \"picture-in-picture=(self)\",\n            \"publickey-credentials-get=(self)\",\n            \"screen-wake-lock=()\",\n            \"sync-xhr=(self)\",\n            \"usb=()\",\n            \"xr-spatial-tracking=()\"\n        ].join(\", \")\n    };\n}\nfunction stringifyRisk(r) {\n    return {\n        score: r.score,\n        level: r.level,\n        issues: r.issues.map((i)=>i.message)\n    };\n}\nfunction summarizeDirectives(directives) {\n    const out = {};\n    const hashRe = /^'sha256-/;\n    const originRe = /^https?:\\/\\//i;\n    for (const [name, list] of Object.entries(directives)){\n        const hashes = list.filter((s)=>hashRe.test(s)).length;\n        const origins = list.filter((s)=>originRe.test(s)).length;\n        const wildcards = list.filter((s)=>s === \"*\").length;\n        out[name] = {\n            sources: list.length,\n            hashes,\n            origins,\n            wildcards\n        };\n    }\n    return out;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1FBQUVDLE9BQU9GLEVBQUVFLEtBQUs7UUFBRUMsUUFBUUgsRUFBRUcsTUFBTSxDQUFDQyxHQUFHLENBQUNDLENBQUFBLElBQUtBLEVBQUVqQixPQUFPO0lBQUU7QUFDaEY7QUFFQSxTQUFTbEIsb0JBQW9CQyxVQUFtQztJQUM5RCxNQUFNbUMsTUFBK0YsQ0FBQztJQUN0RyxNQUFNQyxTQUFTO0lBQ2YsTUFBTUMsV0FBVztJQUNqQixLQUFLLE1BQU0sQ0FBQ0MsTUFBTUMsS0FBSyxJQUFJQyxPQUFPQyxPQUFPLENBQUN6QyxZQUFhO1FBQ3JELE1BQU0wQyxTQUFTSCxLQUFLSSxNQUFNLENBQUNDLENBQUFBLElBQUtSLE9BQU9TLElBQUksQ0FBQ0QsSUFBSTlCLE1BQU07UUFDdEQsTUFBTWdDLFVBQVVQLEtBQUtJLE1BQU0sQ0FBQ0MsQ0FBQUEsSUFBS1AsU0FBU1EsSUFBSSxDQUFDRCxJQUFJOUIsTUFBTTtRQUN6RCxNQUFNaUMsWUFBWVIsS0FBS0ksTUFBTSxDQUFDQyxDQUFBQSxJQUFLQSxNQUFNLEtBQUs5QixNQUFNO1FBQ3BEcUIsR0FBRyxDQUFDRyxLQUFLLEdBQUc7WUFBRVUsU0FBU1QsS0FBS3pCLE1BQU07WUFBRTRCO1lBQVFJO1lBQVNDO1FBQVU7SUFDakU7SUFDQSxPQUFPWjtBQUNUIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXV0b2NzcC8uL2FwcC9hcGkvY3NwL3JvdXRlLnRzPzExNmIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuaW1wb3J0IHsgZmV0Y2hQYWdlIH0gZnJvbSAnLi4vLi4vLi4vc3JjL2ZldGNoJztcclxuaW1wb3J0IHsgY29sbGVjdFJlc291cmNlcyB9IGZyb20gJy4uLy4uLy4uL3NyYy9jb2xsZWN0JztcclxuaW1wb3J0IHsgYnVpbGRDU1AgfSBmcm9tICcuLi8uLi8uLi9zcmMvYnVpbGRlcic7XHJcbmltcG9ydCB7IGNyYXdsIH0gZnJvbSAnLi4vLi4vLi4vc3JjL2NyYXdsJztcclxuaW1wb3J0IHsgYXNzZXNzUG9saWN5IH0gZnJvbSAnLi4vLi4vLi4vc3JjL3Jpc2snO1xyXG5cclxuZXhwb3J0IGNvbnN0IHJldmFsaWRhdGUgPSAwO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXE6IE5leHRSZXF1ZXN0KSB7XHJcbiAgY29uc3QgdXJsID0gcmVxLm5leHRVcmwuc2VhcmNoUGFyYW1zLmdldCgndXJsJyk7XHJcbiAgaWYgKCF1cmwpIHtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnTWlzc2luZyB1cmwgcGFyYW0nIH0sIHsgc3RhdHVzOiA0MDAgfSk7XHJcbiAgfVxyXG4gIGNvbnN0IHN0cmljdFF1ZXJ5ID0gcmVxLm5leHRVcmwuc2VhcmNoUGFyYW1zLmdldCgnc3RyaWN0JykgPT09ICd0cnVlJztcclxuICBjb25zdCBydW50aW1lID0gcmVxLm5leHRVcmwuc2VhcmNoUGFyYW1zLmdldCgncnVudGltZScpID09PSAndHJ1ZSc7XHJcbiAgY29uc3QgZGVwdGhQYXJhbSA9IHJlcS5uZXh0VXJsLnNlYXJjaFBhcmFtcy5nZXQoJ2RlcHRoJyk7XHJcbiAgY29uc3QgZGVwdGggPSBkZXB0aFBhcmFtID8gTWF0aC5taW4oMywgTWF0aC5tYXgoMCwgcGFyc2VJbnQoZGVwdGhQYXJhbSwgMTApIHx8IDApKSA6IDA7IC8vIGNhcCBkZXB0aCB0byAzXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHBhZ2UgPSBhd2FpdCBmZXRjaFBhZ2UodXJsKTtcclxuICAgIGxldCByZXNvdXJjZXMgPSBjb2xsZWN0UmVzb3VyY2VzKHBhZ2UuaHRtbCwgcGFnZS5maW5hbFVybCk7XHJcbiAgICBsZXQgcnVudGltZVN0YXR1czogJ2Rpc2FibGVkJyB8ICdvaycgfCAndW5hdmFpbGFibGUnID0gJ2Rpc2FibGVkJztcclxuICAgIGlmIChydW50aW1lKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgbW9kID0gYXdhaXQgaW1wb3J0KCcuLi8uLi8uLi9zcmMvcnVudGltZScpO1xyXG4gICAgICAgIHJlc291cmNlcyA9IGF3YWl0IG1vZC5jb2xsZWN0UnVudGltZVJlc291cmNlcyhwYWdlLmZpbmFsVXJsLCB7IHdhaXRVbnRpbDogJ25ldHdvcmtpZGxlJyB9KTtcclxuICAgICAgICBydW50aW1lU3RhdHVzID0gJ29rJztcclxuICAgICAgfSBjYXRjaCAoZTogYW55KSB7XHJcbiAgICAgICAgLy8gcGxheXdyaWdodCBub3QgYXZhaWxhYmxlIG9yIHJ1bnRpbWUgZmFpbHVyZTsgY29udGludWUgd2l0aCBzdGF0aWMgcmVzb3VyY2VzXHJcbiAgICAgICAgcnVudGltZVN0YXR1cyA9ICd1bmF2YWlsYWJsZSc7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGxldCBjcmF3bGVkUGFnZXM6IHN0cmluZ1tdID0gW3BhZ2UuZmluYWxVcmxdO1xyXG4gICAgaWYgKGRlcHRoID4gMCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IGNyYXdsUmVzID0gYXdhaXQgY3Jhd2wocGFnZS5maW5hbFVybCwgeyBkZXB0aCwgc2FtZU9yaWdpbk9ubHk6IHRydWUgfSk7XHJcbiAgICAgICAgY3Jhd2xlZFBhZ2VzID0gY3Jhd2xSZXMucGFnZXM7XHJcbiAgICAgICAgLy8gbWVyZ2UgY3Jhd2wgcmVzb3VyY2VzXHJcbiAgICAgICAgY29uc3QgbWVyZ2VkID0gY3Jhd2xSZXMucmVzb3VyY2VzO1xyXG4gICAgICAgIHJlc291cmNlcy5pbmxpbmVTY3JpcHRzLnB1c2goLi4ubWVyZ2VkLmlubGluZVNjcmlwdHMpO1xyXG4gICAgICAgIHJlc291cmNlcy5pbmxpbmVTdHlsZXMucHVzaCguLi5tZXJnZWQuaW5saW5lU3R5bGVzKTtcclxuICAgICAgICBtZXJnZWQuZXh0ZXJuYWxTY3JpcHRPcmlnaW5zLmZvckVhY2gobyA9PiByZXNvdXJjZXMuZXh0ZXJuYWxTY3JpcHRPcmlnaW5zLmFkZChvKSk7XHJcbiAgICAgICAgbWVyZ2VkLmV4dGVybmFsU3R5bGVPcmlnaW5zLmZvckVhY2gobyA9PiByZXNvdXJjZXMuZXh0ZXJuYWxTdHlsZU9yaWdpbnMuYWRkKG8pKTtcclxuICAgICAgICBtZXJnZWQuaW1hZ2VPcmlnaW5zLmZvckVhY2gobyA9PiByZXNvdXJjZXMuaW1hZ2VPcmlnaW5zLmFkZChvKSk7XHJcbiAgICAgICAgbWVyZ2VkLmZvbnRPcmlnaW5zLmZvckVhY2gobyA9PiByZXNvdXJjZXMuZm9udE9yaWdpbnMuYWRkKG8pKTtcclxuICAgICAgICBtZXJnZWQuY29ubmVjdE9yaWdpbnMuZm9yRWFjaChvID0+IHJlc291cmNlcy5jb25uZWN0T3JpZ2lucy5hZGQobykpO1xyXG4gICAgICB9IGNhdGNoIHt9XHJcbiAgICB9XHJcbiAgICAvLyBCdWlsZCBiYXNlbGluZSAobm9uLXN0cmljdCkgYW5kIHN0cmljdCBzaWRlLWJ5LXNpZGVcclxuICAgIGNvbnN0IGJhc2VsaW5lID0gYnVpbGRDU1AocmVzb3VyY2VzLCB7IHN0cmljdDogZmFsc2UsIGV4aXN0aW5nOiBwYWdlLmNzcCB9KTtcclxuICAgIGNvbnN0IHN0cmljdCA9IGJ1aWxkQ1NQKHJlc291cmNlcywgeyBzdHJpY3Q6IHRydWUsIGV4aXN0aW5nOiBwYWdlLmNzcCB9KTtcclxuICAgIGNvbnN0IGFjdGl2ZSA9IHN0cmljdFF1ZXJ5ID8gc3RyaWN0IDogYmFzZWxpbmU7XHJcbiAgY29uc3QgZGlmZk1vZGVzID0gZGlmZkJldHdlZW5Qb2xpY2llcyhiYXNlbGluZS5wb2xpY3ksIHN0cmljdC5wb2xpY3kpO1xyXG4gIGNvbnN0IHN1bW1hcnlCYXNlbGluZSA9IHN1bW1hcml6ZURpcmVjdGl2ZXMoYmFzZWxpbmUuZGlyZWN0aXZlcyk7XHJcbiAgY29uc3Qgc3VtbWFyeVN0cmljdCA9IHN1bW1hcml6ZURpcmVjdGl2ZXMoc3RyaWN0LmRpcmVjdGl2ZXMpO1xyXG4gICAgY29uc3QgaGVhZGVycyA9IHJlY29tbWVuZGVkSGVhZGVycygpO1xyXG4gIGNvbnN0IHJpc2tBY3RpdmUgPSBzdHJpbmdpZnlSaXNrKGFzc2Vzc1BvbGljeShhY3RpdmUucG9saWN5KSk7XHJcbiAgY29uc3Qgcmlza0Jhc2VsaW5lID0gc3RyaW5naWZ5Umlzayhhc3Nlc3NQb2xpY3koYmFzZWxpbmUucG9saWN5KSk7XHJcbiAgY29uc3Qgcmlza1N0cmljdCA9IHN0cmluZ2lmeVJpc2soYXNzZXNzUG9saWN5KHN0cmljdC5wb2xpY3kpKTtcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIGlucHV0OiB1cmwsXHJcbiAgICAgIGZpbmFsVXJsOiBwYWdlLmZpbmFsVXJsLFxyXG4gICAgICBzdGF0dXM6IHBhZ2Uuc3RhdHVzLFxyXG4gICAgICBleGlzdGluZzogcGFnZS5jc3AsXHJcbiAgYmFzZWxpbmU6IHsgcG9saWN5OiBiYXNlbGluZS5wb2xpY3ksIG5vdGVzOiBiYXNlbGluZS5ub3RlcywgZGlmZkV4aXN0aW5nOiBiYXNlbGluZS5kaWZmIH0sXHJcbiAgc3RyaWN0OiB7IHBvbGljeTogc3RyaWN0LnBvbGljeSwgbm90ZXM6IHN0cmljdC5ub3RlcywgZGlmZkV4aXN0aW5nOiBzdHJpY3QuZGlmZiB9LFxyXG4gIGFjdGl2ZU1vZGU6IHN0cmljdFF1ZXJ5ID8gJ3N0cmljdCcgOiAnYmFzZWxpbmUnLFxyXG4gIHJ1bnRpbWU6IHJ1bnRpbWUgPyB0cnVlIDogZmFsc2UsXHJcbiAgICAgIHJ1bnRpbWVTdGF0dXMsXHJcbiAgICAgIGNyYXdsOiB7IGRlcHRoLCBwYWdlczogY3Jhd2xlZFBhZ2VzLCBjb3VudDogY3Jhd2xlZFBhZ2VzLmxlbmd0aCB9LFxyXG4gICAgICBkaWZmTW9kZXMsXHJcbiAgICAgIGhlYWRlcnMsXHJcbiAgICAgIHBvbGljeTogYWN0aXZlLnBvbGljeSxcclxuICAgICAgbm90ZXM6IGFjdGl2ZS5ub3RlcyxcclxuICAgICAgcmlzazogeyBhY3RpdmU6IHJpc2tBY3RpdmUsIGJhc2VsaW5lOiByaXNrQmFzZWxpbmUsIHN0cmljdDogcmlza1N0cmljdCB9LFxyXG4gICAgICBzdW1tYXJpZXM6IHsgYmFzZWxpbmU6IHN1bW1hcnlCYXNlbGluZSwgc3RyaWN0OiBzdW1tYXJ5U3RyaWN0IH1cclxuICAgIH0sIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDYWNoZS1Db250cm9sJzogJ3B1YmxpYywgbWF4LWFnZT0wLCBzLW1heGFnZT0zMDAnXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGU6IGFueSkge1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6IGUubWVzc2FnZSB8fCAnRmFpbGVkJyB9LCB7IHN0YXR1czogNTAwIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZGlmZkJldHdlZW5Qb2xpY2llcyhhOiBzdHJpbmcsIGI6IHN0cmluZykge1xyXG4gIGlmIChhID09PSBiKSByZXR1cm4geyBhZGRlZDogW10sIHJlbW92ZWQ6IFtdIH07XHJcbiAgY29uc3Qgc2V0QSA9IG5ldyBTZXQoYS5zcGxpdCgvO1xccyovKSk7XHJcbiAgY29uc3Qgc2V0QiA9IG5ldyBTZXQoYi5zcGxpdCgvO1xccyovKSk7XHJcbiAgY29uc3QgYWRkZWQ6IHN0cmluZ1tdID0gW107IGNvbnN0IHJlbW92ZWQ6IHN0cmluZ1tdID0gW107XHJcbiAgZm9yIChjb25zdCBkIG9mIHNldEIpIGlmICghc2V0QS5oYXMoZCkpIGFkZGVkLnB1c2goZCk7XHJcbiAgZm9yIChjb25zdCBkIG9mIHNldEEpIGlmICghc2V0Qi5oYXMoZCkpIHJlbW92ZWQucHVzaChkKTtcclxuICByZXR1cm4geyBhZGRlZCwgcmVtb3ZlZCB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiByZWNvbW1lbmRlZEhlYWRlcnMoKSB7XHJcbiAgcmV0dXJuIHtcclxuICAgICdSZWZlcnJlci1Qb2xpY3knOiAnc3RyaWN0LW9yaWdpbi13aGVuLWNyb3NzLW9yaWdpbicsXHJcbiAgICAnUGVybWlzc2lvbnMtUG9saWN5JzogW1xyXG4gICAgICAnYWNjZWxlcm9tZXRlcj0oKScsXHJcbiAgICAgICdhbWJpZW50LWxpZ2h0LXNlbnNvcj0oKScsXHJcbiAgICAgICdhdXRvcGxheT0oc2VsZiknLFxyXG4gICAgICAnYmF0dGVyeT0oKScsXHJcbiAgICAgICdjYW1lcmE9KCknLFxyXG4gICAgICAnZGlzcGxheS1jYXB0dXJlPSgpJyxcclxuICAgICAgJ2VuY3J5cHRlZC1tZWRpYT0oKScsXHJcbiAgICAgICdmdWxsc2NyZWVuPShzZWxmKScsXHJcbiAgICAgICdnZW9sb2NhdGlvbj0oKScsXHJcbiAgICAgICdneXJvc2NvcGU9KCknLFxyXG4gICAgICAnbWFnbmV0b21ldGVyPSgpJyxcclxuICAgICAgJ21pY3JvcGhvbmU9KCknLFxyXG4gICAgICAnbWlkaT0oKScsXHJcbiAgICAgICdwYXltZW50PSgpJyxcclxuICAgICAgJ3BpY3R1cmUtaW4tcGljdHVyZT0oc2VsZiknLFxyXG4gICAgICAncHVibGlja2V5LWNyZWRlbnRpYWxzLWdldD0oc2VsZiknLFxyXG4gICAgICAnc2NyZWVuLXdha2UtbG9jaz0oKScsXHJcbiAgICAgICdzeW5jLXhocj0oc2VsZiknLFxyXG4gICAgICAndXNiPSgpJyxcclxuICAgICAgJ3hyLXNwYXRpYWwtdHJhY2tpbmc9KCknXHJcbiAgICBdLmpvaW4oJywgJylcclxuICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdHJpbmdpZnlSaXNrKHI6IHsgc2NvcmU6IG51bWJlcjsgbGV2ZWw6IHN0cmluZzsgaXNzdWVzOiB7IGlkOiBzdHJpbmc7IG1lc3NhZ2U6IHN0cmluZzsgd2VpZ2h0OiBudW1iZXIgfVtdIH0pIHtcclxuICByZXR1cm4geyBzY29yZTogci5zY29yZSwgbGV2ZWw6IHIubGV2ZWwsIGlzc3Vlczogci5pc3N1ZXMubWFwKGkgPT4gaS5tZXNzYWdlKSB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdW1tYXJpemVEaXJlY3RpdmVzKGRpcmVjdGl2ZXM6IFJlY29yZDxzdHJpbmcsc3RyaW5nW10+KSB7XHJcbiAgY29uc3Qgb3V0OiBSZWNvcmQ8c3RyaW5nLCB7IHNvdXJjZXM6IG51bWJlcjsgaGFzaGVzOiBudW1iZXI7IG9yaWdpbnM6IG51bWJlcjsgd2lsZGNhcmRzOiBudW1iZXIgfT4gPSB7fTtcclxuICBjb25zdCBoYXNoUmUgPSAvXidzaGEyNTYtLztcclxuICBjb25zdCBvcmlnaW5SZSA9IC9eaHR0cHM/OlxcL1xcLy9pO1xyXG4gIGZvciAoY29uc3QgW25hbWUsIGxpc3RdIG9mIE9iamVjdC5lbnRyaWVzKGRpcmVjdGl2ZXMpKSB7XHJcbiAgICBjb25zdCBoYXNoZXMgPSBsaXN0LmZpbHRlcihzID0+IGhhc2hSZS50ZXN0KHMpKS5sZW5ndGg7XHJcbiAgICBjb25zdCBvcmlnaW5zID0gbGlzdC5maWx0ZXIocyA9PiBvcmlnaW5SZS50ZXN0KHMpKS5sZW5ndGg7XHJcbiAgICBjb25zdCB3aWxkY2FyZHMgPSBsaXN0LmZpbHRlcihzID0+IHMgPT09IFwiKlwiKS5sZW5ndGg7XHJcbiAgICBvdXRbbmFtZV0gPSB7IHNvdXJjZXM6IGxpc3QubGVuZ3RoLCBoYXNoZXMsIG9yaWdpbnMsIHdpbGRjYXJkcyB9O1xyXG4gIH1cclxuICByZXR1cm4gb3V0O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJmZXRjaFBhZ2UiLCJjb2xsZWN0UmVzb3VyY2VzIiwiYnVpbGRDU1AiLCJjcmF3bCIsImFzc2Vzc1BvbGljeSIsInJldmFsaWRhdGUiLCJHRVQiLCJyZXEiLCJ1cmwiLCJuZXh0VXJsIiwic2VhcmNoUGFyYW1zIiwiZ2V0IiwianNvbiIsImVycm9yIiwic3RhdHVzIiwic3RyaWN0UXVlcnkiLCJydW50aW1lIiwiZGVwdGhQYXJhbSIsImRlcHRoIiwiTWF0aCIsIm1pbiIsIm1heCIsInBhcnNlSW50IiwicGFnZSIsInJlc291cmNlcyIsImh0bWwiLCJmaW5hbFVybCIsInJ1bnRpbWVTdGF0dXMiLCJtb2QiLCJjb2xsZWN0UnVudGltZVJlc291cmNlcyIsIndhaXRVbnRpbCIsImUiLCJjcmF3bGVkUGFnZXMiLCJjcmF3bFJlcyIsInNhbWVPcmlnaW5Pbmx5IiwicGFnZXMiLCJtZXJnZWQiLCJpbmxpbmVTY3JpcHRzIiwicHVzaCIsImlubGluZVN0eWxlcyIsImV4dGVybmFsU2NyaXB0T3JpZ2lucyIsImZvckVhY2giLCJvIiwiYWRkIiwiZXh0ZXJuYWxTdHlsZU9yaWdpbnMiLCJpbWFnZU9yaWdpbnMiLCJmb250T3JpZ2lucyIsImNvbm5lY3RPcmlnaW5zIiwiYmFzZWxpbmUiLCJzdHJpY3QiLCJleGlzdGluZyIsImNzcCIsImFjdGl2ZSIsImRpZmZNb2RlcyIsImRpZmZCZXR3ZWVuUG9saWNpZXMiLCJwb2xpY3kiLCJzdW1tYXJ5QmFzZWxpbmUiLCJzdW1tYXJpemVEaXJlY3RpdmVzIiwiZGlyZWN0aXZlcyIsInN1bW1hcnlTdHJpY3QiLCJoZWFkZXJzIiwicmVjb21tZW5kZWRIZWFkZXJzIiwicmlza0FjdGl2ZSIsInN0cmluZ2lmeVJpc2siLCJyaXNrQmFzZWxpbmUiLCJyaXNrU3RyaWN0IiwiaW5wdXQiLCJub3RlcyIsImRpZmZFeGlzdGluZyIsImRpZmYiLCJhY3RpdmVNb2RlIiwiY291bnQiLCJsZW5ndGgiLCJyaXNrIiwic3VtbWFyaWVzIiwibWVzc2FnZSIsImEiLCJiIiwiYWRkZWQiLCJyZW1vdmVkIiwic2V0QSIsIlNldCIsInNwbGl0Iiwic2V0QiIsImQiLCJoYXMiLCJqb2luIiwiciIsInNjb3JlIiwibGV2ZWwiLCJpc3N1ZXMiLCJtYXAiLCJpIiwib3V0IiwiaGFzaFJlIiwib3JpZ2luUmUiLCJuYW1lIiwibGlzdCIsIk9iamVjdCIsImVudHJpZXMiLCJoYXNoZXMiLCJmaWx0ZXIiLCJzIiwidGVzdCIsIm9yaWdpbnMiLCJ3aWxkY2FyZHMiLCJzb3VyY2VzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/csp/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/builder.ts":
/*!************************!*\
  !*** ./src/builder.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   buildCSP: () => (/* binding */ buildCSP)\n/* harmony export */ });\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! node:crypto */ \"node:crypto\");\n/* harmony import */ var node_crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(node_crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction buildCSP(resources, opts = {}) {\n    const notes = [];\n    const directives = {\n        \"default-src\": [\n            \"'self'\"\n        ],\n        \"object-src\": [\n            \"'none'\"\n        ],\n        \"base-uri\": [\n            \"'self'\"\n        ],\n        \"frame-ancestors\": [\n            \"'none'\"\n        ]\n    };\n    // Scripts\n    const scriptSrc = [\n        \"'self'\"\n    ];\n    for (const o of resources.externalScriptOrigins)scriptSrc.push(o);\n    for (const code of resources.inlineScripts){\n        const hash = sha256(code);\n        scriptSrc.push(`'sha256-${hash}'`);\n    }\n    if (scriptSrc.length) directives[\"script-src\"] = dedupe(scriptSrc);\n    // Styles\n    const styleSrc = [\n        \"'self'\"\n    ];\n    for (const o of resources.externalStyleOrigins)styleSrc.push(o);\n    for (const css of resources.inlineStyles)styleSrc.push(`'sha256-${sha256(css)}'`);\n    if (styleSrc.length) directives[\"style-src\"] = dedupe(styleSrc);\n    // Images\n    const imgSrc = [\n        \"'self'\",\n        \"data:\"\n    ];\n    for (const o of resources.imageOrigins)imgSrc.push(o);\n    if (imgSrc.length) directives[\"img-src\"] = dedupe(imgSrc);\n    // Fonts\n    if (resources.fontOrigins.size) {\n        const fontSrc = [\n            \"'self'\"\n        ];\n        for (const o of resources.fontOrigins)fontSrc.push(o);\n        directives[\"font-src\"] = dedupe(fontSrc);\n    }\n    // Connect (heuristic currently only preconnect links); always include self\n    const connectSrc = [\n        \"'self'\"\n    ];\n    for (const o of resources.connectOrigins)connectSrc.push(o);\n    directives[\"connect-src\"] = dedupe(connectSrc);\n    // Upgrade insecure + block mixed plugins baseline\n    directives[\"upgrade-insecure-requests\"] = [];\n    // Strict mode adjustments\n    if (opts.strict) {\n        // Remove external origins except self + hashes\n        tightenToHashes(directives, \"script-src\");\n        tightenToHashes(directives, \"style-src\");\n        notes.push(\"Strict mode: external script/style origins removed; only self + hashes allowed.\");\n    }\n    const policy = serialize(directives);\n    const diff = opts.existing ? diffPolicies(opts.existing, policy) : undefined;\n    if (diff && (diff.added.length || diff.removed.length)) {\n        notes.push(\"Diff computed vs existing CSP.\");\n    }\n    return {\n        policy,\n        directives,\n        diff,\n        notes\n    };\n}\nfunction sha256(content) {\n    return node_crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash(\"sha256\").update(content).digest(\"base64\");\n}\nfunction dedupe(arr) {\n    return Array.from(new Set(arr));\n}\nfunction serialize(directives) {\n    return Object.entries(directives).map(([k, v])=>v.length ? `${k} ${v.join(\" \")}` : k).join(\"; \");\n}\nfunction tightenToHashes(directives, name) {\n    const list = directives[name];\n    if (!list) return;\n    const hashes = list.filter((i)=>/^'sha256-/.test(i));\n    const self = list.includes(\"'self'\") ? [\n        \"'self'\"\n    ] : [];\n    directives[name] = dedupe([\n        ...self,\n        ...hashes\n    ]);\n}\nfunction diffPolicies(oldP, newP) {\n    const oldSet = new Set(oldP.split(/;\\s*/));\n    const newSet = new Set(newP.split(/;\\s*/));\n    const added = [];\n    const removed = [];\n    for (const d of newSet)if (!oldSet.has(d)) added.push(d);\n    for (const d of oldSet)if (!newSet.has(d)) removed.push(d);\n    return {\n        added,\n        removed\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYnVpbGRlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBaUM7QUFlMUIsU0FBU0MsU0FBU0MsU0FBNkIsRUFBRUMsT0FBd0IsQ0FBQyxDQUFDO0lBQ2hGLE1BQU1DLFFBQWtCLEVBQUU7SUFDMUIsTUFBTUMsYUFBc0M7UUFDMUMsZUFBZTtZQUFDO1NBQVM7UUFDekIsY0FBYztZQUFDO1NBQVM7UUFDeEIsWUFBWTtZQUFDO1NBQVM7UUFDdEIsbUJBQW1CO1lBQUM7U0FBUztJQUMvQjtJQUVBLFVBQVU7SUFDVixNQUFNQyxZQUFzQjtRQUFDO0tBQVM7SUFDdEMsS0FBSyxNQUFNQyxLQUFLTCxVQUFVTSxxQkFBcUIsQ0FBRUYsVUFBVUcsSUFBSSxDQUFDRjtJQUNoRSxLQUFLLE1BQU1HLFFBQVFSLFVBQVVTLGFBQWEsQ0FBRTtRQUMxQyxNQUFNQyxPQUFPQyxPQUFPSDtRQUNwQkosVUFBVUcsSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFFRyxLQUFLLENBQUMsQ0FBQztJQUNuQztJQUNBLElBQUlOLFVBQVVRLE1BQU0sRUFBRVQsVUFBVSxDQUFDLGFBQWEsR0FBR1UsT0FBT1Q7SUFFeEQsU0FBUztJQUNULE1BQU1VLFdBQXFCO1FBQUM7S0FBUztJQUNyQyxLQUFLLE1BQU1ULEtBQUtMLFVBQVVlLG9CQUFvQixDQUFFRCxTQUFTUCxJQUFJLENBQUNGO0lBQzlELEtBQUssTUFBTVcsT0FBT2hCLFVBQVVpQixZQUFZLENBQUVILFNBQVNQLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRUksT0FBT0ssS0FBSyxDQUFDLENBQUM7SUFDakYsSUFBSUYsU0FBU0YsTUFBTSxFQUFFVCxVQUFVLENBQUMsWUFBWSxHQUFHVSxPQUFPQztJQUV0RCxTQUFTO0lBQ1QsTUFBTUksU0FBbUI7UUFBQztRQUFVO0tBQVE7SUFDNUMsS0FBSyxNQUFNYixLQUFLTCxVQUFVbUIsWUFBWSxDQUFFRCxPQUFPWCxJQUFJLENBQUNGO0lBQ3BELElBQUlhLE9BQU9OLE1BQU0sRUFBRVQsVUFBVSxDQUFDLFVBQVUsR0FBR1UsT0FBT0s7SUFFbEQsUUFBUTtJQUNSLElBQUlsQixVQUFVb0IsV0FBVyxDQUFDQyxJQUFJLEVBQUU7UUFDOUIsTUFBTUMsVUFBb0I7WUFBQztTQUFTO1FBQ3BDLEtBQUssTUFBTWpCLEtBQUtMLFVBQVVvQixXQUFXLENBQUVFLFFBQVFmLElBQUksQ0FBQ0Y7UUFDcERGLFVBQVUsQ0FBQyxXQUFXLEdBQUdVLE9BQU9TO0lBQ2xDO0lBRUEsMkVBQTJFO0lBQzNFLE1BQU1DLGFBQXVCO1FBQUM7S0FBUztJQUN2QyxLQUFLLE1BQU1sQixLQUFLTCxVQUFVd0IsY0FBYyxDQUFFRCxXQUFXaEIsSUFBSSxDQUFDRjtJQUMxREYsVUFBVSxDQUFDLGNBQWMsR0FBR1UsT0FBT1U7SUFFbkMsa0RBQWtEO0lBQ2xEcEIsVUFBVSxDQUFDLDRCQUE0QixHQUFHLEVBQUU7SUFFNUMsMEJBQTBCO0lBQzFCLElBQUlGLEtBQUt3QixNQUFNLEVBQUU7UUFDZiwrQ0FBK0M7UUFDL0NDLGdCQUFnQnZCLFlBQVk7UUFDNUJ1QixnQkFBZ0J2QixZQUFZO1FBQzVCRCxNQUFNSyxJQUFJLENBQUM7SUFDYjtJQUVBLE1BQU1vQixTQUFTQyxVQUFVekI7SUFDekIsTUFBTTBCLE9BQU81QixLQUFLNkIsUUFBUSxHQUFHQyxhQUFhOUIsS0FBSzZCLFFBQVEsRUFBRUgsVUFBVUs7SUFDbkUsSUFBSUgsUUFBU0EsQ0FBQUEsS0FBS0ksS0FBSyxDQUFDckIsTUFBTSxJQUFJaUIsS0FBS0ssT0FBTyxDQUFDdEIsTUFBTSxHQUFHO1FBQ3REVixNQUFNSyxJQUFJLENBQUM7SUFDYjtJQUVBLE9BQU87UUFBRW9CO1FBQVF4QjtRQUFZMEI7UUFBTTNCO0lBQU07QUFDM0M7QUFFQSxTQUFTUyxPQUFPd0IsT0FBZTtJQUM3QixPQUFPckMsNkRBQWlCLENBQUMsVUFBVXVDLE1BQU0sQ0FBQ0YsU0FBU0csTUFBTSxDQUFDO0FBQzVEO0FBRUEsU0FBU3pCLE9BQU8wQixHQUFhO0lBQUksT0FBT0MsTUFBTUMsSUFBSSxDQUFDLElBQUlDLElBQUlIO0FBQU87QUFFbEUsU0FBU1gsVUFBVXpCLFVBQW1DO0lBQ3BELE9BQU93QyxPQUFPQyxPQUFPLENBQUN6QyxZQUNuQjBDLEdBQUcsQ0FBQyxDQUFDLENBQUNDLEdBQUVDLEVBQUUsR0FBS0EsRUFBRW5DLE1BQU0sR0FBRyxDQUFDLEVBQUVrQyxFQUFFLENBQUMsRUFBRUMsRUFBRUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHRixHQUNsREUsSUFBSSxDQUFDO0FBQ1Y7QUFFQSxTQUFTdEIsZ0JBQWdCdkIsVUFBbUMsRUFBRThDLElBQVk7SUFDeEUsTUFBTUMsT0FBTy9DLFVBQVUsQ0FBQzhDLEtBQUs7SUFDN0IsSUFBSSxDQUFDQyxNQUFNO0lBQ1gsTUFBTUMsU0FBU0QsS0FBS0UsTUFBTSxDQUFDQyxDQUFBQSxJQUFLLFlBQVlDLElBQUksQ0FBQ0Q7SUFDakQsTUFBTUUsT0FBT0wsS0FBS00sUUFBUSxDQUFDLFlBQVk7UUFBQztLQUFTLEdBQUcsRUFBRTtJQUN0RHJELFVBQVUsQ0FBQzhDLEtBQUssR0FBR3BDLE9BQU87V0FBSTBDO1dBQVNKO0tBQU87QUFDaEQ7QUFFQSxTQUFTcEIsYUFBYTBCLElBQVksRUFBRUMsSUFBWTtJQUM5QyxNQUFNQyxTQUFTLElBQUlqQixJQUFJZSxLQUFLRyxLQUFLLENBQUM7SUFDbEMsTUFBTUMsU0FBUyxJQUFJbkIsSUFBSWdCLEtBQUtFLEtBQUssQ0FBQztJQUNsQyxNQUFNM0IsUUFBa0IsRUFBRTtJQUFFLE1BQU1DLFVBQW9CLEVBQUU7SUFDeEQsS0FBSyxNQUFNNEIsS0FBS0QsT0FBUSxJQUFJLENBQUNGLE9BQU9JLEdBQUcsQ0FBQ0QsSUFBSTdCLE1BQU0xQixJQUFJLENBQUN1RDtJQUN2RCxLQUFLLE1BQU1BLEtBQUtILE9BQVEsSUFBSSxDQUFDRSxPQUFPRSxHQUFHLENBQUNELElBQUk1QixRQUFRM0IsSUFBSSxDQUFDdUQ7SUFDekQsT0FBTztRQUFFN0I7UUFBT0M7SUFBUTtBQUMxQiIsInNvdXJjZXMiOlsid2VicGFjazovL2F1dG9jc3AvLi9zcmMvYnVpbGRlci50cz9iNWExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnbm9kZTpjcnlwdG8nO1xyXG5pbXBvcnQgeyBDb2xsZWN0ZWRSZXNvdXJjZXMgfSBmcm9tICcuL2NvbGxlY3QnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDU1BCdWlsZE9wdGlvbnMge1xyXG4gIHN0cmljdD86IGJvb2xlYW47IC8vIGlmIHRydWUgdXNlIG5vbmNlcy9oYXNoZXMgb25seSBmb3Igc2NyaXB0cy9zdHlsZXMgYW5kIGRpc2FsbG93IGV4dGVybmFsIG9yaWdpbnMgZXhjZXB0IGV4cGxpY2l0XHJcbiAgZXhpc3Rpbmc/OiBzdHJpbmcgfCBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENTUFJlc3VsdCB7XHJcbiAgcG9saWN5OiBzdHJpbmc7XHJcbiAgZGlyZWN0aXZlczogUmVjb3JkPHN0cmluZyxzdHJpbmdbXT47XHJcbiAgZGlmZj86IHsgYWRkZWQ6IHN0cmluZ1tdOyByZW1vdmVkOiBzdHJpbmdbXSB9O1xyXG4gIG5vdGVzOiBzdHJpbmdbXTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkQ1NQKHJlc291cmNlczogQ29sbGVjdGVkUmVzb3VyY2VzLCBvcHRzOiBDU1BCdWlsZE9wdGlvbnMgPSB7fSk6IENTUFJlc3VsdCB7XHJcbiAgY29uc3Qgbm90ZXM6IHN0cmluZ1tdID0gW107XHJcbiAgY29uc3QgZGlyZWN0aXZlczogUmVjb3JkPHN0cmluZyxzdHJpbmdbXT4gPSB7XHJcbiAgICAnZGVmYXVsdC1zcmMnOiBbXCInc2VsZidcIl0sXHJcbiAgICAnb2JqZWN0LXNyYyc6IFtcIidub25lJ1wiXSxcclxuICAgICdiYXNlLXVyaSc6IFtcIidzZWxmJ1wiXSxcclxuICAgICdmcmFtZS1hbmNlc3RvcnMnOiBbXCInbm9uZSdcIl0sXHJcbiAgfTtcclxuXHJcbiAgLy8gU2NyaXB0c1xyXG4gIGNvbnN0IHNjcmlwdFNyYzogc3RyaW5nW10gPSBbXCInc2VsZidcIl07XHJcbiAgZm9yIChjb25zdCBvIG9mIHJlc291cmNlcy5leHRlcm5hbFNjcmlwdE9yaWdpbnMpIHNjcmlwdFNyYy5wdXNoKG8pO1xyXG4gIGZvciAoY29uc3QgY29kZSBvZiByZXNvdXJjZXMuaW5saW5lU2NyaXB0cykge1xyXG4gICAgY29uc3QgaGFzaCA9IHNoYTI1Nihjb2RlKTtcclxuICAgIHNjcmlwdFNyYy5wdXNoKGAnc2hhMjU2LSR7aGFzaH0nYCk7XHJcbiAgfVxyXG4gIGlmIChzY3JpcHRTcmMubGVuZ3RoKSBkaXJlY3RpdmVzWydzY3JpcHQtc3JjJ10gPSBkZWR1cGUoc2NyaXB0U3JjKTtcclxuXHJcbiAgLy8gU3R5bGVzXHJcbiAgY29uc3Qgc3R5bGVTcmM6IHN0cmluZ1tdID0gW1wiJ3NlbGYnXCJdO1xyXG4gIGZvciAoY29uc3QgbyBvZiByZXNvdXJjZXMuZXh0ZXJuYWxTdHlsZU9yaWdpbnMpIHN0eWxlU3JjLnB1c2gobyk7XHJcbiAgZm9yIChjb25zdCBjc3Mgb2YgcmVzb3VyY2VzLmlubGluZVN0eWxlcykgc3R5bGVTcmMucHVzaChgJ3NoYTI1Ni0ke3NoYTI1Nihjc3MpfSdgKTtcclxuICBpZiAoc3R5bGVTcmMubGVuZ3RoKSBkaXJlY3RpdmVzWydzdHlsZS1zcmMnXSA9IGRlZHVwZShzdHlsZVNyYyk7XHJcblxyXG4gIC8vIEltYWdlc1xyXG4gIGNvbnN0IGltZ1NyYzogc3RyaW5nW10gPSBbXCInc2VsZidcIiwgJ2RhdGE6J107XHJcbiAgZm9yIChjb25zdCBvIG9mIHJlc291cmNlcy5pbWFnZU9yaWdpbnMpIGltZ1NyYy5wdXNoKG8pO1xyXG4gIGlmIChpbWdTcmMubGVuZ3RoKSBkaXJlY3RpdmVzWydpbWctc3JjJ10gPSBkZWR1cGUoaW1nU3JjKTtcclxuXHJcbiAgLy8gRm9udHNcclxuICBpZiAocmVzb3VyY2VzLmZvbnRPcmlnaW5zLnNpemUpIHtcclxuICAgIGNvbnN0IGZvbnRTcmM6IHN0cmluZ1tdID0gW1wiJ3NlbGYnXCJdO1xyXG4gICAgZm9yIChjb25zdCBvIG9mIHJlc291cmNlcy5mb250T3JpZ2lucykgZm9udFNyYy5wdXNoKG8pO1xyXG4gICAgZGlyZWN0aXZlc1snZm9udC1zcmMnXSA9IGRlZHVwZShmb250U3JjKTtcclxuICB9XHJcblxyXG4gIC8vIENvbm5lY3QgKGhldXJpc3RpYyBjdXJyZW50bHkgb25seSBwcmVjb25uZWN0IGxpbmtzKTsgYWx3YXlzIGluY2x1ZGUgc2VsZlxyXG4gIGNvbnN0IGNvbm5lY3RTcmM6IHN0cmluZ1tdID0gW1wiJ3NlbGYnXCJdO1xyXG4gIGZvciAoY29uc3QgbyBvZiByZXNvdXJjZXMuY29ubmVjdE9yaWdpbnMpIGNvbm5lY3RTcmMucHVzaChvKTtcclxuICBkaXJlY3RpdmVzWydjb25uZWN0LXNyYyddID0gZGVkdXBlKGNvbm5lY3RTcmMpO1xyXG5cclxuICAvLyBVcGdyYWRlIGluc2VjdXJlICsgYmxvY2sgbWl4ZWQgcGx1Z2lucyBiYXNlbGluZVxyXG4gIGRpcmVjdGl2ZXNbJ3VwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMnXSA9IFtdO1xyXG5cclxuICAvLyBTdHJpY3QgbW9kZSBhZGp1c3RtZW50c1xyXG4gIGlmIChvcHRzLnN0cmljdCkge1xyXG4gICAgLy8gUmVtb3ZlIGV4dGVybmFsIG9yaWdpbnMgZXhjZXB0IHNlbGYgKyBoYXNoZXNcclxuICAgIHRpZ2h0ZW5Ub0hhc2hlcyhkaXJlY3RpdmVzLCAnc2NyaXB0LXNyYycpO1xyXG4gICAgdGlnaHRlblRvSGFzaGVzKGRpcmVjdGl2ZXMsICdzdHlsZS1zcmMnKTtcclxuICAgIG5vdGVzLnB1c2goJ1N0cmljdCBtb2RlOiBleHRlcm5hbCBzY3JpcHQvc3R5bGUgb3JpZ2lucyByZW1vdmVkOyBvbmx5IHNlbGYgKyBoYXNoZXMgYWxsb3dlZC4nKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IHBvbGljeSA9IHNlcmlhbGl6ZShkaXJlY3RpdmVzKTtcclxuICBjb25zdCBkaWZmID0gb3B0cy5leGlzdGluZyA/IGRpZmZQb2xpY2llcyhvcHRzLmV4aXN0aW5nLCBwb2xpY3kpIDogdW5kZWZpbmVkO1xyXG4gIGlmIChkaWZmICYmIChkaWZmLmFkZGVkLmxlbmd0aCB8fCBkaWZmLnJlbW92ZWQubGVuZ3RoKSkge1xyXG4gICAgbm90ZXMucHVzaCgnRGlmZiBjb21wdXRlZCB2cyBleGlzdGluZyBDU1AuJyk7XHJcbiAgfVxyXG5cclxuICByZXR1cm4geyBwb2xpY3ksIGRpcmVjdGl2ZXMsIGRpZmYsIG5vdGVzIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNoYTI1Nihjb250ZW50OiBzdHJpbmcpIHtcclxuICByZXR1cm4gY3J5cHRvLmNyZWF0ZUhhc2goJ3NoYTI1NicpLnVwZGF0ZShjb250ZW50KS5kaWdlc3QoJ2Jhc2U2NCcpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWR1cGUoYXJyOiBzdHJpbmdbXSkgeyByZXR1cm4gQXJyYXkuZnJvbShuZXcgU2V0KGFycikpOyB9XHJcblxyXG5mdW5jdGlvbiBzZXJpYWxpemUoZGlyZWN0aXZlczogUmVjb3JkPHN0cmluZyxzdHJpbmdbXT4pIHtcclxuICByZXR1cm4gT2JqZWN0LmVudHJpZXMoZGlyZWN0aXZlcylcclxuICAgIC5tYXAoKFtrLHZdKSA9PiB2Lmxlbmd0aCA/IGAke2t9ICR7di5qb2luKCcgJyl9YCA6IGspXHJcbiAgICAuam9pbignOyAnKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdGlnaHRlblRvSGFzaGVzKGRpcmVjdGl2ZXM6IFJlY29yZDxzdHJpbmcsc3RyaW5nW10+LCBuYW1lOiBzdHJpbmcpIHtcclxuICBjb25zdCBsaXN0ID0gZGlyZWN0aXZlc1tuYW1lXTtcclxuICBpZiAoIWxpc3QpIHJldHVybjtcclxuICBjb25zdCBoYXNoZXMgPSBsaXN0LmZpbHRlcihpID0+IC9eJ3NoYTI1Ni0vLnRlc3QoaSkpO1xyXG4gIGNvbnN0IHNlbGYgPSBsaXN0LmluY2x1ZGVzKFwiJ3NlbGYnXCIpID8gW1wiJ3NlbGYnXCJdIDogW107XHJcbiAgZGlyZWN0aXZlc1tuYW1lXSA9IGRlZHVwZShbLi4uc2VsZiwgLi4uaGFzaGVzXSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRpZmZQb2xpY2llcyhvbGRQOiBzdHJpbmcsIG5ld1A6IHN0cmluZykge1xyXG4gIGNvbnN0IG9sZFNldCA9IG5ldyBTZXQob2xkUC5zcGxpdCgvO1xccyovKSk7XHJcbiAgY29uc3QgbmV3U2V0ID0gbmV3IFNldChuZXdQLnNwbGl0KC87XFxzKi8pKTtcclxuICBjb25zdCBhZGRlZDogc3RyaW5nW10gPSBbXTsgY29uc3QgcmVtb3ZlZDogc3RyaW5nW10gPSBbXTtcclxuICBmb3IgKGNvbnN0IGQgb2YgbmV3U2V0KSBpZiAoIW9sZFNldC5oYXMoZCkpIGFkZGVkLnB1c2goZCk7XHJcbiAgZm9yIChjb25zdCBkIG9mIG9sZFNldCkgaWYgKCFuZXdTZXQuaGFzKGQpKSByZW1vdmVkLnB1c2goZCk7XHJcbiAgcmV0dXJuIHsgYWRkZWQsIHJlbW92ZWQgfTtcclxufVxyXG4iXSwibmFtZXMiOlsiY3J5cHRvIiwiYnVpbGRDU1AiLCJyZXNvdXJjZXMiLCJvcHRzIiwibm90ZXMiLCJkaXJlY3RpdmVzIiwic2NyaXB0U3JjIiwibyIsImV4dGVybmFsU2NyaXB0T3JpZ2lucyIsInB1c2giLCJjb2RlIiwiaW5saW5lU2NyaXB0cyIsImhhc2giLCJzaGEyNTYiLCJsZW5ndGgiLCJkZWR1cGUiLCJzdHlsZVNyYyIsImV4dGVybmFsU3R5bGVPcmlnaW5zIiwiY3NzIiwiaW5saW5lU3R5bGVzIiwiaW1nU3JjIiwiaW1hZ2VPcmlnaW5zIiwiZm9udE9yaWdpbnMiLCJzaXplIiwiZm9udFNyYyIsImNvbm5lY3RTcmMiLCJjb25uZWN0T3JpZ2lucyIsInN0cmljdCIsInRpZ2h0ZW5Ub0hhc2hlcyIsInBvbGljeSIsInNlcmlhbGl6ZSIsImRpZmYiLCJleGlzdGluZyIsImRpZmZQb2xpY2llcyIsInVuZGVmaW5lZCIsImFkZGVkIiwicmVtb3ZlZCIsImNvbnRlbnQiLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0IiwiYXJyIiwiQXJyYXkiLCJmcm9tIiwiU2V0IiwiT2JqZWN0IiwiZW50cmllcyIsIm1hcCIsImsiLCJ2Iiwiam9pbiIsIm5hbWUiLCJsaXN0IiwiaGFzaGVzIiwiZmlsdGVyIiwiaSIsInRlc3QiLCJzZWxmIiwiaW5jbHVkZXMiLCJvbGRQIiwibmV3UCIsIm9sZFNldCIsInNwbGl0IiwibmV3U2V0IiwiZCIsImhhcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/builder.ts\n");

/***/ }),

/***/ "(rsc)/./src/collect.ts":
/*!************************!*\
  !*** ./src/collect.ts ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   collectResources: () => (/* binding */ collectResources)\n/* harmony export */ });\n/* harmony import */ var parse5__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! parse5 */ \"(rsc)/./node_modules/parse5/dist/index.js\");\n\nfunction collectResources(html, pageUrl) {\n    const doc = parse5__WEBPACK_IMPORTED_MODULE_0__.parse(html);\n    const baseOrigin = safeOrigin(pageUrl);\n    const res = {\n        inlineScripts: [],\n        inlineStyles: [],\n        externalScriptOrigins: new Set(),\n        externalStyleOrigins: new Set(),\n        imageOrigins: new Set(),\n        fontOrigins: new Set(),\n        connectOrigins: new Set(),\n        dataUris: {\n            scripts: 0,\n            images: 0,\n            styles: 0\n        }\n    };\n    function getAttr(node, name) {\n        if (!node.attrs) return undefined;\n        const found = node.attrs.find((a)=>a.name.toLowerCase() === name.toLowerCase());\n        return found?.value;\n    }\n    function recordOrigin(url) {\n        if (!url) return;\n        if (/^data:/i.test(url)) return;\n        const o = safeOrigin(url);\n        if (o && o !== baseOrigin) return o;\n        return o; // always return origin (even if same) for future policy tightening\n    }\n    function walk(node) {\n        if (node.nodeName === \"#text\") return;\n        const tag = node.tagName?.toLowerCase();\n        if (tag === \"script\") {\n            const src = getAttr(node, \"src\");\n            if (src) {\n                const o = recordOrigin(src);\n                if (o) res.externalScriptOrigins.add(o);\n            } else if (node.childNodes) {\n                const code = node.childNodes.map((c)=>c.value || \"\").join(\"\");\n                if (code.trim()) res.inlineScripts.push(code);\n            }\n        }\n        if (tag === \"link\") {\n            const rel = (getAttr(node, \"rel\") || \"\").toLowerCase();\n            const href = getAttr(node, \"href\");\n            if (rel.includes(\"stylesheet\") && href) {\n                const o = recordOrigin(href);\n                if (o) res.externalStyleOrigins.add(o);\n            }\n            if (/preconnect|dns-prefetch/.test(rel) && href) {\n                const o = recordOrigin(href);\n                if (o) res.connectOrigins.add(o);\n            }\n        }\n        if (tag === \"img\") {\n            const src = getAttr(node, \"src\");\n            if (src) {\n                if (/^data:/i.test(src)) res.dataUris.images++;\n                const o = recordOrigin(src);\n                if (o) res.imageOrigins.add(o);\n            }\n        }\n        if (tag === \"style\" && node.childNodes) {\n            const css = node.childNodes.map((c)=>c.value || \"\").join(\"\");\n            if (css.trim()) res.inlineStyles.push(css);\n            // crude font src detection\n            const fontUrlMatches = Array.from(css.matchAll(/url\\(([^)]+)\\)/gi));\n            const fontUrls = fontUrlMatches.map((m)=>(m[1] || \"\").replace(/['\"]/g, \"\"));\n            for (const fu of fontUrls){\n                if (/^data:/i.test(fu)) continue;\n                else {\n                    const o = recordOrigin(fu);\n                    if (o) res.fontOrigins.add(o);\n                }\n            }\n        }\n        if (node.childNodes) node.childNodes.forEach(walk);\n    }\n    walk(doc);\n    return res;\n}\nfunction safeOrigin(u) {\n    try {\n        const url = new URL(u, \"http://dummy\");\n        return url.origin;\n    } catch  {\n        return undefined;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxHQUFHLENBQUMsQ0FBQ0MsSUFBV0EsRUFBRWQsS0FBSyxJQUFJLElBQUllLElBQUksQ0FBQztZQUNoRSxJQUFJTSxJQUFJTCxJQUFJLElBQUl0QyxJQUFJRSxZQUFZLENBQUNxQyxJQUFJLENBQUNJO1lBQ3RDLDJCQUEyQjtZQUMvQixNQUFNQyxpQkFBaUJDLE1BQU1DLElBQUksQ0FBQ0gsSUFBSUksUUFBUSxDQUFDO1lBQy9DLE1BQU1DLFdBQVdKLGVBQWVULEdBQUcsQ0FBQ2MsQ0FBQUEsSUFBSyxDQUFDQSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUMsRUFBR0MsT0FBTyxDQUFDLFNBQVE7WUFDbEUsS0FBSyxNQUFNQyxNQUFNSCxTQUFVO2dCQUN6QixJQUFJLFVBQVV2QixJQUFJLENBQUMwQixLQUFLO3FCQUFlO29CQUNyQyxNQUFNekIsSUFBSUgsYUFBYTRCO29CQUN2QixJQUFJekIsR0FBRzFCLElBQUlPLFdBQVcsQ0FBQ3lCLEdBQUcsQ0FBQ047Z0JBQzdCO1lBQ0Y7UUFDRjtRQUNBLElBQUlaLEtBQUttQixVQUFVLEVBQUVuQixLQUFLbUIsVUFBVSxDQUFDbUIsT0FBTyxDQUFDekI7SUFDL0M7SUFFQUEsS0FBSy9CO0lBQ0wsT0FBT0k7QUFDVDtBQUVBLFNBQVNELFdBQVdzRCxDQUFTO0lBQzNCLElBQUk7UUFBRSxNQUFNN0IsTUFBTSxJQUFJOEIsSUFBSUQsR0FBRztRQUFpQixPQUFPN0IsSUFBSStCLE1BQU07SUFBRSxFQUFFLE9BQU07UUFBRSxPQUFPdEM7SUFBVztBQUMvRiIsInNvdXJjZXMiOlsid2VicGFjazovL2F1dG9jc3AvLi9zcmMvY29sbGVjdC50cz82YzgxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhcnNlNSBmcm9tICdwYXJzZTUnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDb2xsZWN0ZWRSZXNvdXJjZXMge1xyXG4gIGlubGluZVNjcmlwdHM6IHN0cmluZ1tdO1xyXG4gIGlubGluZVN0eWxlczogc3RyaW5nW107XHJcbiAgZXh0ZXJuYWxTY3JpcHRPcmlnaW5zOiBTZXQ8c3RyaW5nPjtcclxuICBleHRlcm5hbFN0eWxlT3JpZ2luczogU2V0PHN0cmluZz47XHJcbiAgaW1hZ2VPcmlnaW5zOiBTZXQ8c3RyaW5nPjtcclxuICBmb250T3JpZ2luczogU2V0PHN0cmluZz47XHJcbiAgY29ubmVjdE9yaWdpbnM6IFNldDxzdHJpbmc+OyAvLyBoZXVyaXN0aWM6IGZldGNoL1hIUiBlbmRwb2ludHMgKHRvIGJlIGFkZGVkIGluIHJ1bnRpbWUgcGhhc2UgbGF0ZXIpXHJcbiAgZGF0YVVyaXM6IHsgc2NyaXB0czogbnVtYmVyOyBpbWFnZXM6IG51bWJlcjsgc3R5bGVzOiBudW1iZXIgfTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbGxlY3RSZXNvdXJjZXMoaHRtbDogc3RyaW5nLCBwYWdlVXJsOiBzdHJpbmcpOiBDb2xsZWN0ZWRSZXNvdXJjZXMge1xyXG4gIGNvbnN0IGRvYzogYW55ID0gcGFyc2U1LnBhcnNlKGh0bWwpO1xyXG4gIGNvbnN0IGJhc2VPcmlnaW4gPSBzYWZlT3JpZ2luKHBhZ2VVcmwpO1xyXG4gIGNvbnN0IHJlczogQ29sbGVjdGVkUmVzb3VyY2VzID0ge1xyXG4gICAgaW5saW5lU2NyaXB0czogW10sXHJcbiAgICBpbmxpbmVTdHlsZXM6IFtdLFxyXG4gICAgZXh0ZXJuYWxTY3JpcHRPcmlnaW5zOiBuZXcgU2V0KCksXHJcbiAgICBleHRlcm5hbFN0eWxlT3JpZ2luczogbmV3IFNldCgpLFxyXG4gICAgaW1hZ2VPcmlnaW5zOiBuZXcgU2V0KCksXHJcbiAgICBmb250T3JpZ2luczogbmV3IFNldCgpLFxyXG4gICAgY29ubmVjdE9yaWdpbnM6IG5ldyBTZXQoKSxcclxuICAgIGRhdGFVcmlzOiB7IHNjcmlwdHM6IDAsIGltYWdlczogMCwgc3R5bGVzOiAwIH1cclxuICB9O1xyXG5cclxuICBmdW5jdGlvbiBnZXRBdHRyKG5vZGU6IGFueSwgbmFtZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcclxuICAgIGlmICghbm9kZS5hdHRycykgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIGNvbnN0IGZvdW5kID0gbm9kZS5hdHRycy5maW5kKChhOiBhbnkpID0+IGEubmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCkpO1xyXG4gICAgcmV0dXJuIGZvdW5kPy52YWx1ZTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHJlY29yZE9yaWdpbih1cmw/OiBzdHJpbmcpIHtcclxuICAgIGlmICghdXJsKSByZXR1cm47XHJcbiAgICBpZiAoL15kYXRhOi9pLnRlc3QodXJsKSkgcmV0dXJuO1xyXG4gICAgY29uc3QgbyA9IHNhZmVPcmlnaW4odXJsKTtcclxuICAgIGlmIChvICYmIG8gIT09IGJhc2VPcmlnaW4pIHJldHVybiBvO1xyXG4gICAgcmV0dXJuIG87IC8vIGFsd2F5cyByZXR1cm4gb3JpZ2luIChldmVuIGlmIHNhbWUpIGZvciBmdXR1cmUgcG9saWN5IHRpZ2h0ZW5pbmdcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIHdhbGsobm9kZTogYW55KSB7XHJcbiAgICBpZiAobm9kZS5ub2RlTmFtZSA9PT0gJyN0ZXh0JykgcmV0dXJuO1xyXG4gICAgY29uc3QgdGFnID0gbm9kZS50YWdOYW1lPy50b0xvd2VyQ2FzZSgpO1xyXG4gICAgaWYgKHRhZyA9PT0gJ3NjcmlwdCcpIHtcclxuICAgICAgY29uc3Qgc3JjID0gZ2V0QXR0cihub2RlLCAnc3JjJyk7XHJcbiAgICAgIGlmIChzcmMpIHtcclxuICAgICAgICBjb25zdCBvID0gcmVjb3JkT3JpZ2luKHNyYyk7XHJcbiAgICAgICAgaWYgKG8pIHJlcy5leHRlcm5hbFNjcmlwdE9yaWdpbnMuYWRkKG8pO1xyXG4gICAgICB9IGVsc2UgaWYgKG5vZGUuY2hpbGROb2Rlcykge1xyXG4gICAgICAgIGNvbnN0IGNvZGUgPSBub2RlLmNoaWxkTm9kZXMubWFwKChjOiBhbnkpID0+IGMudmFsdWUgfHwgJycpLmpvaW4oJycpO1xyXG4gICAgICAgIGlmIChjb2RlLnRyaW0oKSkgcmVzLmlubGluZVNjcmlwdHMucHVzaChjb2RlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHRhZyA9PT0gJ2xpbmsnKSB7XHJcbiAgICAgIGNvbnN0IHJlbCA9IChnZXRBdHRyKG5vZGUsICdyZWwnKSB8fCAnJykudG9Mb3dlckNhc2UoKTtcclxuICAgICAgY29uc3QgaHJlZiA9IGdldEF0dHIobm9kZSwgJ2hyZWYnKTtcclxuICAgICAgaWYgKHJlbC5pbmNsdWRlcygnc3R5bGVzaGVldCcpICYmIGhyZWYpIHtcclxuICAgICAgICBjb25zdCBvID0gcmVjb3JkT3JpZ2luKGhyZWYpO1xyXG4gICAgICAgIGlmIChvKSByZXMuZXh0ZXJuYWxTdHlsZU9yaWdpbnMuYWRkKG8pO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICgvcHJlY29ubmVjdHxkbnMtcHJlZmV0Y2gvLnRlc3QocmVsKSAmJiBocmVmKSB7XHJcbiAgICAgICAgY29uc3QgbyA9IHJlY29yZE9yaWdpbihocmVmKTtcclxuICAgICAgICBpZiAobykgcmVzLmNvbm5lY3RPcmlnaW5zLmFkZChvKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKHRhZyA9PT0gJ2ltZycpIHtcclxuICAgICAgY29uc3Qgc3JjID0gZ2V0QXR0cihub2RlLCAnc3JjJyk7XHJcbiAgICAgIGlmIChzcmMpIHtcclxuICAgICAgICBpZiAoL15kYXRhOi9pLnRlc3Qoc3JjKSkgcmVzLmRhdGFVcmlzLmltYWdlcysrO1xyXG4gICAgICAgIGNvbnN0IG8gPSByZWNvcmRPcmlnaW4oc3JjKTtcclxuICAgICAgICBpZiAobykgcmVzLmltYWdlT3JpZ2lucy5hZGQobyk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmICh0YWcgPT09ICdzdHlsZScgJiYgbm9kZS5jaGlsZE5vZGVzKSB7XHJcbiAgICAgIGNvbnN0IGNzcyA9IG5vZGUuY2hpbGROb2Rlcy5tYXAoKGM6IGFueSkgPT4gYy52YWx1ZSB8fCAnJykuam9pbignJyk7XHJcbiAgICAgIGlmIChjc3MudHJpbSgpKSByZXMuaW5saW5lU3R5bGVzLnB1c2goY3NzKTtcclxuICAgICAgLy8gY3J1ZGUgZm9udCBzcmMgZGV0ZWN0aW9uXHJcbiAgY29uc3QgZm9udFVybE1hdGNoZXMgPSBBcnJheS5mcm9tKGNzcy5tYXRjaEFsbCgvdXJsXFwoKFteKV0rKVxcKS9naSkpIGFzIFJlZ0V4cE1hdGNoQXJyYXlbXTtcclxuICBjb25zdCBmb250VXJscyA9IGZvbnRVcmxNYXRjaGVzLm1hcChtID0+IChtWzFdIHx8ICcnKS5yZXBsYWNlKC9bJ1wiXS9nLCcnKSk7XHJcbiAgICAgIGZvciAoY29uc3QgZnUgb2YgZm9udFVybHMpIHtcclxuICAgICAgICBpZiAoL15kYXRhOi9pLnRlc3QoZnUpKSBjb250aW51ZTsgZWxzZSB7XHJcbiAgICAgICAgICBjb25zdCBvID0gcmVjb3JkT3JpZ2luKGZ1KTtcclxuICAgICAgICAgIGlmIChvKSByZXMuZm9udE9yaWdpbnMuYWRkKG8pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKG5vZGUuY2hpbGROb2Rlcykgbm9kZS5jaGlsZE5vZGVzLmZvckVhY2god2Fsayk7XHJcbiAgfVxyXG5cclxuICB3YWxrKGRvYyk7XHJcbiAgcmV0dXJuIHJlcztcclxufVxyXG5cclxuZnVuY3Rpb24gc2FmZU9yaWdpbih1OiBzdHJpbmcpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gIHRyeSB7IGNvbnN0IHVybCA9IG5ldyBVUkwodSwgJ2h0dHA6Ly9kdW1teScpOyByZXR1cm4gdXJsLm9yaWdpbjsgfSBjYXRjaCB7IHJldHVybiB1bmRlZmluZWQ7IH1cclxufVxyXG4iXSwibmFtZXMiOlsicGFyc2U1IiwiY29sbGVjdFJlc291cmNlcyIsImh0bWwiLCJwYWdlVXJsIiwiZG9jIiwicGFyc2UiLCJiYXNlT3JpZ2luIiwic2FmZU9yaWdpbiIsInJlcyIsImlubGluZVNjcmlwdHMiLCJpbmxpbmVTdHlsZXMiLCJleHRlcm5hbFNjcmlwdE9yaWdpbnMiLCJTZXQiLCJleHRlcm5hbFN0eWxlT3JpZ2lucyIsImltYWdlT3JpZ2lucyIsImZvbnRPcmlnaW5zIiwiY29ubmVjdE9yaWdpbnMiLCJkYXRhVXJpcyIsInNjcmlwdHMiLCJpbWFnZXMiLCJzdHlsZXMiLCJnZXRBdHRyIiwibm9kZSIsIm5hbWUiLCJhdHRycyIsInVuZGVmaW5lZCIsImZvdW5kIiwiZmluZCIsImEiLCJ0b0xvd2VyQ2FzZSIsInZhbHVlIiwicmVjb3JkT3JpZ2luIiwidXJsIiwidGVzdCIsIm8iLCJ3YWxrIiwibm9kZU5hbWUiLCJ0YWciLCJ0YWdOYW1lIiwic3JjIiwiYWRkIiwiY2hpbGROb2RlcyIsImNvZGUiLCJtYXAiLCJjIiwiam9pbiIsInRyaW0iLCJwdXNoIiwicmVsIiwiaHJlZiIsImluY2x1ZGVzIiwiY3NzIiwiZm9udFVybE1hdGNoZXMiLCJBcnJheSIsImZyb20iLCJtYXRjaEFsbCIsImZvbnRVcmxzIiwibSIsInJlcGxhY2UiLCJmdSIsImZvckVhY2giLCJ1IiwiVVJMIiwib3JpZ2luIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/collect.ts\n");

/***/ }),

/***/ "(rsc)/./src/crawl.ts":
/*!**********************!*\
  !*** ./src/crawl.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   crawl: () => (/* binding */ crawl)\n/* harmony export */ });\n/* harmony import */ var _fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./fetch */ \"(rsc)/./src/fetch.ts\");\n/* harmony import */ var _collect__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./collect */ \"(rsc)/./src/collect.ts\");\n\n\nasync function crawl(startUrl, opts) {\n    const depth = Math.max(0, opts.depth);\n    const maxPages = opts.maxPages ?? 15;\n    const visited = new Set();\n    const queue = [\n        {\n            url: startUrl,\n            d: 0\n        }\n    ];\n    const origin = new URL(startUrl).origin;\n    const aggregate = {\n        inlineScripts: [],\n        inlineStyles: [],\n        externalScriptOrigins: new Set(),\n        externalStyleOrigins: new Set(),\n        imageOrigins: new Set(),\n        fontOrigins: new Set(),\n        connectOrigins: new Set(),\n        dataUris: {\n            scripts: 0,\n            images: 0,\n            styles: 0\n        }\n    };\n    while(queue.length && visited.size < maxPages){\n        const { url, d } = queue.shift();\n        if (visited.has(url)) continue;\n        visited.add(url);\n        try {\n            const page = await (0,_fetch__WEBPACK_IMPORTED_MODULE_0__.fetchPage)(url);\n            const res = (0,_collect__WEBPACK_IMPORTED_MODULE_1__.collectResources)(page.html, page.finalUrl);\n            mergeResources(aggregate, res);\n            if (d < depth) {\n                // Extract links for next level (simple regex approach to avoid extra parser traversal cost)\n                const linkMatches = page.html.matchAll(/<a[^>]+href=[\"']([^\"'#?]+)[\"']/gi);\n                for (const m of linkMatches){\n                    const href = m[1];\n                    if (!href) continue;\n                    let next;\n                    try {\n                        next = new URL(href, page.finalUrl).toString();\n                    } catch  {\n                        continue;\n                    }\n                    if (opts.sameOriginOnly !== false && new URL(next).origin !== origin) continue;\n                    if (!visited.has(next)) queue.push({\n                        url: next,\n                        d: d + 1\n                    });\n                }\n            }\n        } catch  {\n        // Skip errors silently for now (could add logging)\n        }\n    }\n    return {\n        pages: Array.from(visited),\n        resources: aggregate\n    };\n}\nfunction mergeResources(base, extra) {\n    base.inlineScripts.push(...extra.inlineScripts);\n    base.inlineStyles.push(...extra.inlineStyles);\n    extra.externalScriptOrigins.forEach((o)=>base.externalScriptOrigins.add(o));\n    extra.externalStyleOrigins.forEach((o)=>base.externalStyleOrigins.add(o));\n    extra.imageOrigins.forEach((o)=>base.imageOrigins.add(o));\n    extra.fontOrigins.forEach((o)=>base.fontOrigins.add(o));\n    extra.connectOrigins.forEach((o)=>base.connectOrigins.add(o));\n    base.dataUris.scripts += extra.dataUris.scripts;\n    base.dataUris.images += extra.dataUris.images;\n    base.dataUris.styles += extra.dataUris.styles;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNDLENBQUFBLElBQUtILEtBQUs1QixXQUFXLENBQUNVLEdBQUcsQ0FBQ3FCO0lBQ3BERixNQUFNNUIsY0FBYyxDQUFDNkIsT0FBTyxDQUFDQyxDQUFBQSxJQUFLSCxLQUFLM0IsY0FBYyxDQUFDUyxHQUFHLENBQUNxQjtJQUMxREgsS0FBSzFCLFFBQVEsQ0FBQ0MsT0FBTyxJQUFJMEIsTUFBTTNCLFFBQVEsQ0FBQ0MsT0FBTztJQUMvQ3lCLEtBQUsxQixRQUFRLENBQUNFLE1BQU0sSUFBSXlCLE1BQU0zQixRQUFRLENBQUNFLE1BQU07SUFDN0N3QixLQUFLMUIsUUFBUSxDQUFDRyxNQUFNLElBQUl3QixNQUFNM0IsUUFBUSxDQUFDRyxNQUFNO0FBQy9DIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXV0b2NzcC8uL3NyYy9jcmF3bC50cz9kZWViIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGZldGNoUGFnZSB9IGZyb20gJy4vZmV0Y2gnO1xyXG5pbXBvcnQgeyBjb2xsZWN0UmVzb3VyY2VzLCBDb2xsZWN0ZWRSZXNvdXJjZXMgfSBmcm9tICcuL2NvbGxlY3QnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDcmF3bE9wdGlvbnMgeyBkZXB0aDogbnVtYmVyOyBzYW1lT3JpZ2luT25seT86IGJvb2xlYW47IG1heFBhZ2VzPzogbnVtYmVyOyB9XHJcbmV4cG9ydCBpbnRlcmZhY2UgQ3Jhd2xSZXN1bHQgeyBwYWdlczogc3RyaW5nW107IHJlc291cmNlczogQ29sbGVjdGVkUmVzb3VyY2VzOyB9XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3Jhd2woc3RhcnRVcmw6IHN0cmluZywgb3B0czogQ3Jhd2xPcHRpb25zKTogUHJvbWlzZTxDcmF3bFJlc3VsdD4ge1xyXG4gIGNvbnN0IGRlcHRoID0gTWF0aC5tYXgoMCwgb3B0cy5kZXB0aCk7XHJcbiAgY29uc3QgbWF4UGFnZXMgPSBvcHRzLm1heFBhZ2VzID8/IDE1O1xyXG4gIGNvbnN0IHZpc2l0ZWQgPSBuZXcgU2V0PHN0cmluZz4oKTtcclxuICBjb25zdCBxdWV1ZTogeyB1cmw6IHN0cmluZzsgZDogbnVtYmVyIH1bXSA9IFt7IHVybDogc3RhcnRVcmwsIGQ6IDAgfV07XHJcbiAgY29uc3Qgb3JpZ2luID0gbmV3IFVSTChzdGFydFVybCkub3JpZ2luO1xyXG5cclxuICBjb25zdCBhZ2dyZWdhdGU6IENvbGxlY3RlZFJlc291cmNlcyA9IHtcclxuICAgIGlubGluZVNjcmlwdHM6IFtdLFxyXG4gICAgaW5saW5lU3R5bGVzOiBbXSxcclxuICAgIGV4dGVybmFsU2NyaXB0T3JpZ2luczogbmV3IFNldCgpLFxyXG4gICAgZXh0ZXJuYWxTdHlsZU9yaWdpbnM6IG5ldyBTZXQoKSxcclxuICAgIGltYWdlT3JpZ2luczogbmV3IFNldCgpLFxyXG4gICAgZm9udE9yaWdpbnM6IG5ldyBTZXQoKSxcclxuICAgIGNvbm5lY3RPcmlnaW5zOiBuZXcgU2V0KCksXHJcbiAgICBkYXRhVXJpczogeyBzY3JpcHRzOiAwLCBpbWFnZXM6IDAsIHN0eWxlczogMCB9XHJcbiAgfTtcclxuXHJcbiAgd2hpbGUgKHF1ZXVlLmxlbmd0aCAmJiB2aXNpdGVkLnNpemUgPCBtYXhQYWdlcykge1xyXG4gICAgY29uc3QgeyB1cmwsIGQgfSA9IHF1ZXVlLnNoaWZ0KCkhO1xyXG4gICAgaWYgKHZpc2l0ZWQuaGFzKHVybCkpIGNvbnRpbnVlO1xyXG4gICAgdmlzaXRlZC5hZGQodXJsKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IHBhZ2UgPSBhd2FpdCBmZXRjaFBhZ2UodXJsKTtcclxuICAgICAgY29uc3QgcmVzID0gY29sbGVjdFJlc291cmNlcyhwYWdlLmh0bWwsIHBhZ2UuZmluYWxVcmwpO1xyXG4gICAgICBtZXJnZVJlc291cmNlcyhhZ2dyZWdhdGUsIHJlcyk7XHJcblxyXG4gICAgICBpZiAoZCA8IGRlcHRoKSB7XHJcbiAgICAgICAgLy8gRXh0cmFjdCBsaW5rcyBmb3IgbmV4dCBsZXZlbCAoc2ltcGxlIHJlZ2V4IGFwcHJvYWNoIHRvIGF2b2lkIGV4dHJhIHBhcnNlciB0cmF2ZXJzYWwgY29zdClcclxuICAgICAgICBjb25zdCBsaW5rTWF0Y2hlcyA9IHBhZ2UuaHRtbC5tYXRjaEFsbCgvPGFbXj5dK2hyZWY9W1wiJ10oW15cIicjP10rKVtcIiddL2dpKTtcclxuICAgICAgICBmb3IgKGNvbnN0IG0gb2YgbGlua01hdGNoZXMpIHtcclxuICAgICAgICAgIGNvbnN0IGhyZWYgPSBtWzFdO1xyXG4gICAgICAgICAgaWYgKCFocmVmKSBjb250aW51ZTtcclxuICAgICAgICAgIGxldCBuZXh0OiBzdHJpbmc7XHJcbiAgICAgICAgICB0cnkgeyBuZXh0ID0gbmV3IFVSTChocmVmLCBwYWdlLmZpbmFsVXJsKS50b1N0cmluZygpOyB9IGNhdGNoIHsgY29udGludWU7IH1cclxuICAgICAgICAgIGlmIChvcHRzLnNhbWVPcmlnaW5Pbmx5ICE9PSBmYWxzZSAmJiBuZXcgVVJMKG5leHQpLm9yaWdpbiAhPT0gb3JpZ2luKSBjb250aW51ZTtcclxuICAgICAgICAgIGlmICghdmlzaXRlZC5oYXMobmV4dCkpIHF1ZXVlLnB1c2goeyB1cmw6IG5leHQsIGQ6IGQgKyAxIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCB7XHJcbiAgICAgIC8vIFNraXAgZXJyb3JzIHNpbGVudGx5IGZvciBub3cgKGNvdWxkIGFkZCBsb2dnaW5nKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHsgcGFnZXM6IEFycmF5LmZyb20odmlzaXRlZCksIHJlc291cmNlczogYWdncmVnYXRlIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG1lcmdlUmVzb3VyY2VzKGJhc2U6IENvbGxlY3RlZFJlc291cmNlcywgZXh0cmE6IENvbGxlY3RlZFJlc291cmNlcykge1xyXG4gIGJhc2UuaW5saW5lU2NyaXB0cy5wdXNoKC4uLmV4dHJhLmlubGluZVNjcmlwdHMpO1xyXG4gIGJhc2UuaW5saW5lU3R5bGVzLnB1c2goLi4uZXh0cmEuaW5saW5lU3R5bGVzKTtcclxuICBleHRyYS5leHRlcm5hbFNjcmlwdE9yaWdpbnMuZm9yRWFjaChvID0+IGJhc2UuZXh0ZXJuYWxTY3JpcHRPcmlnaW5zLmFkZChvKSk7XHJcbiAgZXh0cmEuZXh0ZXJuYWxTdHlsZU9yaWdpbnMuZm9yRWFjaChvID0+IGJhc2UuZXh0ZXJuYWxTdHlsZU9yaWdpbnMuYWRkKG8pKTtcclxuICBleHRyYS5pbWFnZU9yaWdpbnMuZm9yRWFjaChvID0+IGJhc2UuaW1hZ2VPcmlnaW5zLmFkZChvKSk7XHJcbiAgZXh0cmEuZm9udE9yaWdpbnMuZm9yRWFjaChvID0+IGJhc2UuZm9udE9yaWdpbnMuYWRkKG8pKTtcclxuICBleHRyYS5jb25uZWN0T3JpZ2lucy5mb3JFYWNoKG8gPT4gYmFzZS5jb25uZWN0T3JpZ2lucy5hZGQobykpO1xyXG4gIGJhc2UuZGF0YVVyaXMuc2NyaXB0cyArPSBleHRyYS5kYXRhVXJpcy5zY3JpcHRzO1xyXG4gIGJhc2UuZGF0YVVyaXMuaW1hZ2VzICs9IGV4dHJhLmRhdGFVcmlzLmltYWdlcztcclxuICBiYXNlLmRhdGFVcmlzLnN0eWxlcyArPSBleHRyYS5kYXRhVXJpcy5zdHlsZXM7XHJcbn1cclxuIl0sIm5hbWVzIjpbImZldGNoUGFnZSIsImNvbGxlY3RSZXNvdXJjZXMiLCJjcmF3bCIsInN0YXJ0VXJsIiwib3B0cyIsImRlcHRoIiwiTWF0aCIsIm1heCIsIm1heFBhZ2VzIiwidmlzaXRlZCIsIlNldCIsInF1ZXVlIiwidXJsIiwiZCIsIm9yaWdpbiIsIlVSTCIsImFnZ3JlZ2F0ZSIsImlubGluZVNjcmlwdHMiLCJpbmxpbmVTdHlsZXMiLCJleHRlcm5hbFNjcmlwdE9yaWdpbnMiLCJleHRlcm5hbFN0eWxlT3JpZ2lucyIsImltYWdlT3JpZ2lucyIsImZvbnRPcmlnaW5zIiwiY29ubmVjdE9yaWdpbnMiLCJkYXRhVXJpcyIsInNjcmlwdHMiLCJpbWFnZXMiLCJzdHlsZXMiLCJsZW5ndGgiLCJzaXplIiwic2hpZnQiLCJoYXMiLCJhZGQiLCJwYWdlIiwicmVzIiwiaHRtbCIsImZpbmFsVXJsIiwibWVyZ2VSZXNvdXJjZXMiLCJsaW5rTWF0Y2hlcyIsIm1hdGNoQWxsIiwibSIsImhyZWYiLCJuZXh0IiwidG9TdHJpbmciLCJzYW1lT3JpZ2luT25seSIsInB1c2giLCJwYWdlcyIsIkFycmF5IiwiZnJvbSIsInJlc291cmNlcyIsImJhc2UiLCJleHRyYSIsImZvckVhY2giLCJvIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/crawl.ts\n");

/***/ }),

/***/ "(rsc)/./src/fetch.ts":
/*!**********************!*\
  !*** ./src/fetch.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchPage: () => (/* binding */ fetchPage)\n/* harmony export */ });\nasync function fetchPage(url, timeoutMs = 15000) {\n    const controller = new AbortController();\n    const t = setTimeout(()=>controller.abort(), timeoutMs);\n    try {\n        const res = await fetch(url, {\n            redirect: \"follow\",\n            signal: controller.signal\n        });\n        const headers = {};\n        res.headers.forEach((v, k)=>{\n            headers[k.toLowerCase()] = v;\n        });\n        const html = await res.text();\n        return {\n            url,\n            finalUrl: res.url,\n            status: res.status,\n            headers,\n            html,\n            csp: headers[\"content-security-policy\"]\n        };\n    } finally{\n        clearTimeout(t);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvZmV0Y2gudHMiLCJtYXBwaW5ncyI6Ijs7OztBQVVPLGVBQWVBLFVBQVVDLEdBQVcsRUFBRUMsWUFBWSxLQUFLO0lBQzVELE1BQU1DLGFBQWEsSUFBSUM7SUFDdkIsTUFBTUMsSUFBSUMsV0FBVyxJQUFNSCxXQUFXSSxLQUFLLElBQUlMO0lBQy9DLElBQUk7UUFDRixNQUFNTSxNQUFNLE1BQU1DLE1BQU1SLEtBQUs7WUFBRVMsVUFBVTtZQUFVQyxRQUFRUixXQUFXUSxNQUFNO1FBQUM7UUFDN0UsTUFBTUMsVUFBa0MsQ0FBQztRQUN6Q0osSUFBSUksT0FBTyxDQUFDQyxPQUFPLENBQUMsQ0FBQ0MsR0FBR0M7WUFBUUgsT0FBTyxDQUFDRyxFQUFFQyxXQUFXLEdBQUcsR0FBR0Y7UUFBRztRQUM5RCxNQUFNRyxPQUFPLE1BQU1ULElBQUlVLElBQUk7UUFDM0IsT0FBTztZQUNMakI7WUFDQWtCLFVBQVVYLElBQUlQLEdBQUc7WUFDakJtQixRQUFRWixJQUFJWSxNQUFNO1lBQ2xCUjtZQUNBSztZQUNBSSxLQUFLVCxPQUFPLENBQUMsMEJBQTBCO1FBQ3pDO0lBQ0YsU0FBVTtRQUNSVSxhQUFhakI7SUFDZjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYXV0b2NzcC8uL3NyYy9mZXRjaC50cz9mYmViIl0sInNvdXJjZXNDb250ZW50IjpbIlxyXG5leHBvcnQgaW50ZXJmYWNlIEZldGNoZWRQYWdlIHtcclxuICB1cmw6IHN0cmluZztcclxuICBmaW5hbFVybDogc3RyaW5nO1xyXG4gIHN0YXR1czogbnVtYmVyO1xyXG4gIGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XHJcbiAgaHRtbDogc3RyaW5nO1xyXG4gIGNzcD86IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoUGFnZSh1cmw6IHN0cmluZywgdGltZW91dE1zID0gMTUwMDApOiBQcm9taXNlPEZldGNoZWRQYWdlPiB7XHJcbiAgY29uc3QgY29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKTtcclxuICBjb25zdCB0ID0gc2V0VGltZW91dCgoKSA9PiBjb250cm9sbGVyLmFib3J0KCksIHRpbWVvdXRNcyk7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHVybCwgeyByZWRpcmVjdDogJ2ZvbGxvdycsIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwgfSk7XHJcbiAgICBjb25zdCBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XHJcbiAgICByZXMuaGVhZGVycy5mb3JFYWNoKCh2LCBrKSA9PiB7IGhlYWRlcnNbay50b0xvd2VyQ2FzZSgpXSA9IHY7IH0pO1xyXG4gICAgY29uc3QgaHRtbCA9IGF3YWl0IHJlcy50ZXh0KCk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1cmwsXHJcbiAgICAgIGZpbmFsVXJsOiByZXMudXJsLFxyXG4gICAgICBzdGF0dXM6IHJlcy5zdGF0dXMsXHJcbiAgICAgIGhlYWRlcnMsXHJcbiAgICAgIGh0bWwsXHJcbiAgICAgIGNzcDogaGVhZGVyc1snY29udGVudC1zZWN1cml0eS1wb2xpY3knXVxyXG4gICAgfTtcclxuICB9IGZpbmFsbHkge1xyXG4gICAgY2xlYXJUaW1lb3V0KHQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiZmV0Y2hQYWdlIiwidXJsIiwidGltZW91dE1zIiwiY29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInQiLCJzZXRUaW1lb3V0IiwiYWJvcnQiLCJyZXMiLCJmZXRjaCIsInJlZGlyZWN0Iiwic2lnbmFsIiwiaGVhZGVycyIsImZvckVhY2giLCJ2IiwiayIsInRvTG93ZXJDYXNlIiwiaHRtbCIsInRleHQiLCJmaW5hbFVybCIsInN0YXR1cyIsImNzcCIsImNsZWFyVGltZW91dCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/fetch.ts\n");

/***/ }),

/***/ "(rsc)/./src/risk.ts":
/*!*********************!*\
  !*** ./src/risk.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assessPolicy: () => (/* binding */ assessPolicy)\n/* harmony export */ });\n// Heuristic scoring: start at 100, subtract for risky patterns / missing hardening\nfunction assessPolicy(policy) {\n    const issues = [];\n    let score = 100;\n    const lower = policy.toLowerCase();\n    function add(id, message, weight) {\n        issues.push({\n            id,\n            message,\n            weight\n        });\n        score -= weight;\n    }\n    // Parse directives into map\n    const parts = policy.split(/;\\s*/).filter(Boolean);\n    const dirMap = {};\n    for (const p of parts){\n        const [name, ...rest] = p.trim().split(/\\s+/);\n        if (!name) continue;\n        dirMap[name] = rest;\n    }\n    // Key directives presence\n    const required = [\n        \"default-src\",\n        \"object-src\",\n        \"frame-ancestors\",\n        \"base-uri\"\n    ];\n    for (const r of required){\n        if (!(r in dirMap)) add(\"missing-\" + r, `Missing directive: ${r}`, 8);\n    }\n    // default-src fallback risk\n    if (dirMap[\"default-src\"] && dirMap[\"default-src\"].includes(\"*\")) {\n        add(\"default-wildcard\", \"default-src allows * (overly permissive)\", 15);\n    }\n    // wildcard usage in script/style/img connect\n    const wildcardDirs = [\n        \"script-src\",\n        \"style-src\",\n        \"img-src\",\n        \"connect-src\"\n    ];\n    for (const d of wildcardDirs){\n        const v = dirMap[d];\n        if (!v) continue;\n        if (v.includes(\"*\")) add(d + \"-wildcard\", `${d} has *`, 12);\n        if (v.some((tok)=>tok.startsWith(\"http:\"))) add(d + \"-http\", `${d} includes insecure http: origin`, 10);\n        if (v.some((tok)=>tok === \"'unsafe-inline'\")) add(d + \"-unsafe-inline\", `${d} uses 'unsafe-inline'`, 14);\n        if (v.some((tok)=>tok === \"'unsafe-eval'\")) add(d + \"-unsafe-eval\", `${d} uses 'unsafe-eval'`, 10);\n    }\n    // object-src should be 'none'\n    if (dirMap[\"object-src\"] && !dirMap[\"object-src\"].includes(\"'none'\")) {\n        add(\"object-not-none\", \"object-src should be 'none'\", 10);\n    }\n    // frame-ancestors should be restrictive\n    if (dirMap[\"frame-ancestors\"] && dirMap[\"frame-ancestors\"].includes(\"*\")) {\n        add(\"frame-any\", \"frame-ancestors uses * (clickjacking risk)\", 12);\n    }\n    // upgrade-insecure-requests recommended\n    if (!parts.some((p)=>p.startsWith(\"upgrade-insecure-requests\"))) {\n        add(\"missing-upgrade\", \"Missing upgrade-insecure-requests (recommended)\", 4);\n    }\n    // Hash count heuristic (encourage hashing vs unsafe-inline)\n    const hashCount = (policy.match(/'sha256-[A-Za-z0-9+/=]+'/g) || []).length;\n    if (hashCount === 0 && dirMap[\"script-src\"] && dirMap[\"script-src\"].length > 0 && !dirMap[\"script-src\"].includes(\"'unsafe-inline'\")) {\n        add(\"no-hashes\", \"No script hashes detected (consider hashing inline scripts)\", 5);\n    }\n    if (score < 0) score = 0;\n    const level = score >= 80 ? \"low\" : score >= 55 ? \"medium\" : \"high\";\n    return {\n        score,\n        level,\n        issues\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZCxNQUFNLENBQUMsYUFBYSxJQUFJQSxNQUFNLENBQUMsYUFBYSxDQUFDZ0IsTUFBTSxHQUFHLEtBQUssQ0FBQ2hCLE1BQU0sQ0FBQyxhQUFhLENBQUNPLFFBQVEsQ0FBQyxvQkFBb0I7UUFDbkloQixJQUFJLGFBQWEsK0RBQStEO0lBQ2xGO0lBRUEsSUFBSUgsUUFBUSxHQUFHQSxRQUFRO0lBQ3ZCLE1BQU02QixRQUE2QjdCLFNBQVMsS0FBSyxRQUFRQSxTQUFTLEtBQUssV0FBVztJQUNsRixPQUFPO1FBQUVBO1FBQU82QjtRQUFPOUI7SUFBTztBQUNoQyIsInNvdXJjZXMiOlsid2VicGFjazovL2F1dG9jc3AvLi9zcmMvcmlzay50cz8xNGIzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgUmlza0lzc3VlIHsgaWQ6IHN0cmluZzsgbWVzc2FnZTogc3RyaW5nOyB3ZWlnaHQ6IG51bWJlcjsgfVxyXG5leHBvcnQgaW50ZXJmYWNlIFJpc2tSZXN1bHQgeyBzY29yZTogbnVtYmVyOyBsZXZlbDogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJzsgaXNzdWVzOiBSaXNrSXNzdWVbXTsgfVxyXG5cclxuLy8gSGV1cmlzdGljIHNjb3Jpbmc6IHN0YXJ0IGF0IDEwMCwgc3VidHJhY3QgZm9yIHJpc2t5IHBhdHRlcm5zIC8gbWlzc2luZyBoYXJkZW5pbmdcclxuZXhwb3J0IGZ1bmN0aW9uIGFzc2Vzc1BvbGljeShwb2xpY3k6IHN0cmluZyk6IFJpc2tSZXN1bHQge1xyXG4gIGNvbnN0IGlzc3VlczogUmlza0lzc3VlW10gPSBbXTtcclxuICBsZXQgc2NvcmUgPSAxMDA7XHJcbiAgY29uc3QgbG93ZXIgPSBwb2xpY3kudG9Mb3dlckNhc2UoKTtcclxuXHJcbiAgZnVuY3Rpb24gYWRkKGlkOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZywgd2VpZ2h0OiBudW1iZXIpIHtcclxuICAgIGlzc3Vlcy5wdXNoKHsgaWQsIG1lc3NhZ2UsIHdlaWdodCB9KTtcclxuICAgIHNjb3JlIC09IHdlaWdodDtcclxuICB9XHJcblxyXG4gIC8vIFBhcnNlIGRpcmVjdGl2ZXMgaW50byBtYXBcclxuICBjb25zdCBwYXJ0cyA9IHBvbGljeS5zcGxpdCgvO1xccyovKS5maWx0ZXIoQm9vbGVhbik7XHJcbiAgY29uc3QgZGlyTWFwOiBSZWNvcmQ8c3RyaW5nLHN0cmluZ1tdPiA9IHt9O1xyXG4gIGZvciAoY29uc3QgcCBvZiBwYXJ0cykge1xyXG4gICAgY29uc3QgW25hbWUsIC4uLnJlc3RdID0gcC50cmltKCkuc3BsaXQoL1xccysvKTtcclxuICAgIGlmICghbmFtZSkgY29udGludWU7XHJcbiAgICBkaXJNYXBbbmFtZV0gPSByZXN0O1xyXG4gIH1cclxuXHJcbiAgLy8gS2V5IGRpcmVjdGl2ZXMgcHJlc2VuY2VcclxuICBjb25zdCByZXF1aXJlZCA9IFsnZGVmYXVsdC1zcmMnLCdvYmplY3Qtc3JjJywnZnJhbWUtYW5jZXN0b3JzJywnYmFzZS11cmknXTtcclxuICBmb3IgKGNvbnN0IHIgb2YgcmVxdWlyZWQpIHtcclxuICAgIGlmICghKHIgaW4gZGlyTWFwKSkgYWRkKCdtaXNzaW5nLScrciwgYE1pc3NpbmcgZGlyZWN0aXZlOiAke3J9YCwgOCk7XHJcbiAgfVxyXG5cclxuICAvLyBkZWZhdWx0LXNyYyBmYWxsYmFjayByaXNrXHJcbiAgaWYgKGRpck1hcFsnZGVmYXVsdC1zcmMnXSAmJiBkaXJNYXBbJ2RlZmF1bHQtc3JjJ10uaW5jbHVkZXMoXCIqXCIpKSB7XHJcbiAgICBhZGQoJ2RlZmF1bHQtd2lsZGNhcmQnLCBcImRlZmF1bHQtc3JjIGFsbG93cyAqIChvdmVybHkgcGVybWlzc2l2ZSlcIiwgMTUpO1xyXG4gIH1cclxuXHJcbiAgLy8gd2lsZGNhcmQgdXNhZ2UgaW4gc2NyaXB0L3N0eWxlL2ltZyBjb25uZWN0XHJcbiAgY29uc3Qgd2lsZGNhcmREaXJzID0gWydzY3JpcHQtc3JjJywnc3R5bGUtc3JjJywnaW1nLXNyYycsJ2Nvbm5lY3Qtc3JjJ107XHJcbiAgZm9yIChjb25zdCBkIG9mIHdpbGRjYXJkRGlycykge1xyXG4gICAgY29uc3QgdiA9IGRpck1hcFtkXTsgaWYgKCF2KSBjb250aW51ZTtcclxuICAgIGlmICh2LmluY2x1ZGVzKFwiKlwiKSkgYWRkKGQrJy13aWxkY2FyZCcsIGAke2R9IGhhcyAqYCwgMTIpO1xyXG4gICAgaWYgKHYuc29tZSh0b2sgPT4gdG9rLnN0YXJ0c1dpdGgoJ2h0dHA6JykpKSBhZGQoZCsnLWh0dHAnLCBgJHtkfSBpbmNsdWRlcyBpbnNlY3VyZSBodHRwOiBvcmlnaW5gLCAxMCk7XHJcbiAgICBpZiAodi5zb21lKHRvayA9PiB0b2sgPT09IFwiJ3Vuc2FmZS1pbmxpbmUnXCIpKSBhZGQoZCsnLXVuc2FmZS1pbmxpbmUnLCBgJHtkfSB1c2VzICd1bnNhZmUtaW5saW5lJ2AsIDE0KTtcclxuICAgIGlmICh2LnNvbWUodG9rID0+IHRvayA9PT0gXCIndW5zYWZlLWV2YWwnXCIpKSBhZGQoZCsnLXVuc2FmZS1ldmFsJywgYCR7ZH0gdXNlcyAndW5zYWZlLWV2YWwnYCwgMTApO1xyXG4gIH1cclxuXHJcbiAgLy8gb2JqZWN0LXNyYyBzaG91bGQgYmUgJ25vbmUnXHJcbiAgaWYgKGRpck1hcFsnb2JqZWN0LXNyYyddICYmICFkaXJNYXBbJ29iamVjdC1zcmMnXS5pbmNsdWRlcyhcIidub25lJ1wiKSkge1xyXG4gICAgYWRkKCdvYmplY3Qtbm90LW5vbmUnLCBcIm9iamVjdC1zcmMgc2hvdWxkIGJlICdub25lJ1wiLCAxMCk7XHJcbiAgfVxyXG5cclxuICAvLyBmcmFtZS1hbmNlc3RvcnMgc2hvdWxkIGJlIHJlc3RyaWN0aXZlXHJcbiAgaWYgKGRpck1hcFsnZnJhbWUtYW5jZXN0b3JzJ10gJiYgZGlyTWFwWydmcmFtZS1hbmNlc3RvcnMnXS5pbmNsdWRlcyhcIipcIikpIHtcclxuICAgIGFkZCgnZnJhbWUtYW55JywgXCJmcmFtZS1hbmNlc3RvcnMgdXNlcyAqIChjbGlja2phY2tpbmcgcmlzaylcIiwgMTIpO1xyXG4gIH1cclxuXHJcbiAgLy8gdXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyByZWNvbW1lbmRlZFxyXG4gIGlmICghcGFydHMuc29tZShwID0+IHAuc3RhcnRzV2l0aCgndXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cycpKSkge1xyXG4gICAgYWRkKCdtaXNzaW5nLXVwZ3JhZGUnLCAnTWlzc2luZyB1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIChyZWNvbW1lbmRlZCknLCA0KTtcclxuICB9XHJcblxyXG4gIC8vIEhhc2ggY291bnQgaGV1cmlzdGljIChlbmNvdXJhZ2UgaGFzaGluZyB2cyB1bnNhZmUtaW5saW5lKVxyXG4gIGNvbnN0IGhhc2hDb3VudCA9IChwb2xpY3kubWF0Y2goLydzaGEyNTYtW0EtWmEtejAtOSsvPV0rJy9nKSB8fCBbXSkubGVuZ3RoO1xyXG4gIGlmIChoYXNoQ291bnQgPT09IDAgJiYgZGlyTWFwWydzY3JpcHQtc3JjJ10gJiYgZGlyTWFwWydzY3JpcHQtc3JjJ10ubGVuZ3RoID4gMCAmJiAhZGlyTWFwWydzY3JpcHQtc3JjJ10uaW5jbHVkZXMoXCIndW5zYWZlLWlubGluZSdcIikpIHtcclxuICAgIGFkZCgnbm8taGFzaGVzJywgJ05vIHNjcmlwdCBoYXNoZXMgZGV0ZWN0ZWQgKGNvbnNpZGVyIGhhc2hpbmcgaW5saW5lIHNjcmlwdHMpJywgNSk7XHJcbiAgfVxyXG5cclxuICBpZiAoc2NvcmUgPCAwKSBzY29yZSA9IDA7XHJcbiAgY29uc3QgbGV2ZWw6IFJpc2tSZXN1bHRbJ2xldmVsJ10gPSBzY29yZSA+PSA4MCA/ICdsb3cnIDogc2NvcmUgPj0gNTUgPyAnbWVkaXVtJyA6ICdoaWdoJztcclxuICByZXR1cm4geyBzY29yZSwgbGV2ZWwsIGlzc3VlcyB9O1xyXG59XHJcbiJdLCJuYW1lcyI6WyJhc3Nlc3NQb2xpY3kiLCJwb2xpY3kiLCJpc3N1ZXMiLCJzY29yZSIsImxvd2VyIiwidG9Mb3dlckNhc2UiLCJhZGQiLCJpZCIsIm1lc3NhZ2UiLCJ3ZWlnaHQiLCJwdXNoIiwicGFydHMiLCJzcGxpdCIsImZpbHRlciIsIkJvb2xlYW4iLCJkaXJNYXAiLCJwIiwibmFtZSIsInJlc3QiLCJ0cmltIiwicmVxdWlyZWQiLCJyIiwiaW5jbHVkZXMiLCJ3aWxkY2FyZERpcnMiLCJkIiwidiIsInNvbWUiLCJ0b2siLCJzdGFydHNXaXRoIiwiaGFzaENvdW50IiwibWF0Y2giLCJsZW5ndGgiLCJsZXZlbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/risk.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/parse5","vendor-chunks/entities"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcsp%2Froute&page=%2Fapi%2Fcsp%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcsp%2Froute.ts&appDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cjavie%5CDesktop%5CGame%20Online%20Html%5Cautocsp&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();